<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-09-28T11:06:50-06:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The Principle of Inclusion and Exclusion: the Size of a Union</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><link href="https://webwork-dev.aimath.org/webwork2_files/js/apps/MathView/mathview.css" rel="stylesheet">
<script src="https://webwork-dev.aimath.org/webwork2_files/js/vendor/iframe-resizer/js/iframeResizer.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="custom-styles.css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(  \def\negchoose#1#2{\genfrac{[}{]}{0pt}{}{#1}{#2}_{-1}}
  \newcommand{\mchoose}[2]{\left(\!\binom{#1}{#2}\!\right)}
  \newcommand{\cycle}[1]{\arraycolsep 5 pt
  \left(\begin{array}#1\end{array}\right)}
  \newcommand{\importantarrow}{\Rightarrow}
  \newcommand{\qchoose}[2]{\left[{#1\atop#2}\right]_q}
  \newcommand{\bp}{
  \begin{enumerate}{\setcounter{enumi}{\value{problemnumber}}}}
  \newcommand{\ep}{\setcounter{problemnumber}{\value{enumi}}
  \end{enumerate}}
  \newcommand{\ignore}[1]{}
  \renewcommand{\bottomfraction}{.8}
  \renewcommand{\topfraction}{.8}
  \newcommand{\apple}{\text{üçé}}
  \newcommand{\ap}{\apple}
  \newcommand{\banana}{\text{üçå}}
  \newcommand{\ba}{\banana}
  \newcommand{\pear}{\text{üçê}}
  \newcommand{\pe}{\pear}
  \DeclareMathOperator{\Fix}{Fix}
  \DeclareMathOperator{\Orb}{Orb}
  \newcommand{\F}{\mathcal{F}}
\newcommand{\alert}{\fbox}
\def\d{\displaystyle}
\def\course{Math 228}
\newcommand{\f}[1]{\mathfrak #1}
\newcommand{\s}[1]{\mathscr #1}
\def\N{\mathbb N}
\def\B{\mathbf{B}}
\def\circleA{(-.5,0) circle (1)}
\def\Z{\mathbb Z}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\Q{\mathbb Q}
\def\circleB{(.5,0) circle (1)}
\def\R{\mathbb R}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\C{\mathbb C}
\def\circleC{(0,-1) circle (1)}
\def\F{\mathbb F}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\A{\mathbb A}
\def\twosetbox{(-2,-1.5) rectangle (2,1.5)}
\def\X{\mathbb X}
\def\threesetbox{(-2,-2.5) rectangle (2,1.5)}
\def\E{\mathbb E}
\def\O{\mathbb O}
\def\U{\mathcal U}
\def\pow{\mathcal P}
\def\inv{^{-1}}
\def\nrml{\triangleleft}
\def\st{:}
\def\~{\widetilde}
\def\rem{\mathcal R}
\def\sigalg{$\sigma$-algebra }
\def\Gal{\mbox{Gal}}
\def\iff{\leftrightarrow}
\def\Iff{\Leftrightarrow}
\def\land{\wedge}
\def\And{\bigwedge}
\def\entry{\entry}
\def\AAnd{\d\bigwedge\mkern-18mu\bigwedge}
\def\Vee{\bigvee}
\def\VVee{\d\Vee\mkern-18mu\Vee}
\def\imp{\rightarrow}
\def\Imp{\Rightarrow}
\def\Fi{\Leftarrow}
\def\var{\mbox{var}}
\def\Th{\mbox{Th}}
\def\entry{\entry}
\def\sat{\mbox{Sat}}
\def\con{\mbox{Con}}
\def\iffmodels{\bmodels\models}
\def\dbland{\bigwedge \!\!\bigwedge}
\def\dom{\mbox{dom}}
\def\rng{\mbox{range}}
\def\isom{\cong}
\DeclareMathOperator{\wgt}{wgt}
\newcommand{\vtx}[2]{node[fill,circle,inner sep=0pt, minimum size=4pt,label=#1:#2]{}}
\newcommand{\va}[1]{\vtx{above}{#1}}
\newcommand{\vb}[1]{\vtx{below}{#1}}
\newcommand{\vr}[1]{\vtx{right}{#1}}
\newcommand{\vl}[1]{\vtx{left}{#1}}
\renewcommand{\v}{\vtx{above}{}}
\def\circleA{(-.5,0) circle (1)}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\circleB{(.5,0) circle (1)}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\circleC{(0,-1) circle (1)}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\twosetbox{(-2,-1.4) rectangle (2,1.4)}
\def\threesetbox{(-2.5,-2.4) rectangle (2.5,1.4)}
\def\ansfilename{practice-answers}
\def\shadowprops{{fill=black!50,shadow xshift=0.5ex,shadow yshift=0.5ex,path fading={circle with fuzzy edge 10 percent}}}
\newcommand{\hexbox}[3]{
  \def\x{-cos{30}*\r*#1+cos{30}*#2*\r*2}
  \def\y{-\r*#1-sin{30}*\r*#1}
  \draw (\x,\y) +(90:\r) -- +(30:\r) -- +(-30:\r) -- +(-90:\r) -- +(-150:\r) -- +(150:\r) -- cycle;
  \draw (\x,\y) node{#3};
}
\newcommand{\card}[1]{\left| #1 \right|}
\newcommand{\twoline}[2]{\begin{pmatrix}#1 \\ #2 \end{pmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href="http://discrete.openmathbooks.org/ecm/" target="_blank"><img src="images/cover.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="ecm.html"><span class="title">Exploring Combinatorial Mathematics</span></a></h1>
<p class="byline"></p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="ch_advanced.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch_advanced.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="sec_adv-genfunctions.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="ch_advanced.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch_advanced.html" title="Up">Up</a><a class="next-button button toolbar-item" href="sec_adv-genfunctions.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
<li><a href="preface.html" data-scroll="preface">Preface</a></li>
</ul>
</li>
<li class="link">
<a href="ch_basic-combinatorics.html" data-scroll="ch_basic-combinatorics"><span class="codenumber">1</span> <span class="title">Basic Combinatorics</span></a><ul>
<li><a href="sec_counting-binom.html" data-scroll="sec_counting-binom">Pascal's Triangle and Binomial Coefficients</a></li>
<li><a href="sec_basic-proofs.html" data-scroll="sec_basic-proofs">Proofs in Combinatorics</a></li>
<li><a href="sec_basic-quotient.html" data-scroll="sec_basic-quotient">Counting with Equivalence</a></li>
<li><a href="sec_basic-recursion.html" data-scroll="sec_basic-recursion">Counting with Recursion</a></li>
<li><a href="sec_basic-catalan.html" data-scroll="sec_basic-catalan">The Catalan Numbers</a></li>
</ul>
</li>
<li class="link">
<a href="ch_advanced.html" data-scroll="ch_advanced"><span class="codenumber">2</span> <span class="title">Advanced Combinatorics</span></a><ul>
<li><a href="sec_adv-pie.html" data-scroll="sec_adv-pie" class="active">The Principle of Inclusion and Exclusion: the Size of a Union</a></li>
<li><a href="sec_adv-genfunctions.html" data-scroll="sec_adv-genfunctions">Generating Functions</a></li>
<li><a href="sec_adv-stirling.html" data-scroll="sec_adv-stirling">Partitions of Sets</a></li>
<li><a href="sec_adv-linearparts.html" data-scroll="sec_adv-linearparts">Partitions of Integers</a></li>
</ul>
</li>
<li class="link">
<a href="ch_graphtheory.html" data-scroll="ch_graphtheory"><span class="codenumber">3</span> <span class="title">Graph Theory</span></a><ul>
<li><a href="sec_gt-intro.html" data-scroll="sec_gt-intro">Definitions</a></li>
<li><a href="sec_paths.html" data-scroll="sec_paths">Walking Around Graphs</a></li>
<li><a href="sec_planar.html" data-scroll="sec_planar">Planar Graphs and Euler's Formula</a></li>
<li><a href="sec_eulerapps.html" data-scroll="sec_eulerapps">Applications of Euler's Formula</a></li>
<li><a href="sec_coloring.html" data-scroll="sec_coloring">Coloring</a></li>
<li><a href="sec_matchings.html" data-scroll="sec_matchings">Matching in Bipartite Graphs</a></li>
</ul>
</li>
<li class="link"><a href="backmatter.html" data-scroll="backmatter"><span class="title">Back Matter</span></a></li>
<li class="link">
<a href="app_projects.html" data-scroll="app_projects"><span class="codenumber">A</span> <span class="title">Group Projects</span></a><ul>
<li><a href="exercises-1.html" data-scroll="exercises-1">Project 1: Paths and Binomial Coefficients</a></li>
<li><a href="exercises-2.html" data-scroll="exercises-2">Project 2: On Triangular Numbers</a></li>
<li><a href="exercises-3.html" data-scroll="exercises-3">Project 3: Fibonacci</a></li>
<li><a href="exercises-4.html" data-scroll="exercises-4">Project 4: Generalized Pascal Triangles</a></li>
<li><a href="exercises-5.html" data-scroll="exercises-5">Project 5: A Pascal-like Triangle of Eulerian Numbers</a></li>
<li><a href="exercises-6.html" data-scroll="exercises-6">Project 6: The Leibniz Harmonic Triangle</a></li>
<li><a href="exercises-7.html" data-scroll="exercises-7">Project 7: The Twelve Days of Christmas (in the Discrete Math Style)</a></li>
</ul>
</li>
<li class="link">
<a href="ch_background.html" data-scroll="ch_background"><span class="codenumber">B</span> <span class="title">Background Material</span></a><ul>
<li><a href="sec_background-statements.html" data-scroll="sec_background-statements">Mathematical Statements</a></li>
<li><a href="sec_intro-sets.html" data-scroll="sec_intro-sets">Sets</a></li>
<li><a href="sec_background-functions.html" data-scroll="sec_background-functions">Functions</a></li>
<li><a href="sec_background-logic.html" data-scroll="sec_background-logic">Propositional Logic</a></li>
<li><a href="sec_background-proofs.html" data-scroll="sec_background-proofs">Proofs</a></li>
<li><a href="sec_background-induction.html" data-scroll="sec_background-induction">Induction</a></li>
</ul>
</li>
<li class="link"><a href="solutions-1.html" data-scroll="solutions-1"><span class="codenumber">C</span> <span class="title">Hints to selected activities and exercises</span></a></li>
<li class="link"><a href="solutions-2.html" data-scroll="solutions-2"><span class="codenumber">D</span> <span class="title">Solutions to selected exercises</span></a></li>
<li class="link"><a href="appendix-gfdl.html" data-scroll="appendix-gfdl"><span class="codenumber">E</span> <span class="title">GNU Free Documentation License</span></a></li>
<li class="link"><a href="appendix-4.html" data-scroll="appendix-4"><span class="codenumber">F</span> <span class="title">List of Symbols</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
<li class="link"><a href="colophon-2.html" data-scroll="colophon-2"><span class="title">Colophon</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="sec_adv-pie"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.1</span> <span class="title">The Principle of Inclusion and Exclusion: the Size of a Union</span>
</h2>
<a href="sec_adv-pie.html" class="permalink">¬∂</a><section class="introduction" id="introduction-43"><p id="p-749">One of our very first counting principles was the <dfn class="terminology">sum principle</dfn> which says that the size of a union of disjoint sets is the sum of their sizes. Computing the size of overlapping sets requires, quite naturally, information about how they overlap. Taking such information into account will allow us to develop a powerful extension of the sum principle known as the ‚Äúprinciple of inclusion and exclusion.‚Äù</p></section><section class="subsection" id="subsection-14"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.1.1</span> <span class="title">Unions of two or three sets</span>
</h3>
<article class="project-like" id="fertilizer2"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">132</span>.</h6>
<p id="p-750">In a biology lab study of the effects of basic fertilizer ingredients on plants, 16 plants are treated with potash, 16 plants are treated with phosphate, and among these plants, eight are treated with both phosphate and potash. No other treatments are used. How many plants receive at least one treatment? If 32 plants are studied, how many receive no treatment?</p></article><article class="project-like" id="twosetintersection"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">133</span>.</h6>
<p id="p-752">Give a formula for the size of the union \(A\cup B\) of two sets \(A\) in terms of the sizes \(|A|\) of \(A\text{,}\) \(|B|\) of \(B\text{,}\) and \(|A\cap B|\) of \(A\cap B\text{.}\) If \(A\) and \(B\) are subsets of some ‚Äúuniversal‚Äù set \(U\text{,}\) express the size of the complement \(U-(A\cup B)\) in terms of the sizes \(|U|\) of \(U\text{,}\) \(|A|\) of \(A\text{,}\) \(|B|\) of \(B\text{,}\) and \(|A\cap B|\) of \(A\cap B\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-94" id="hint-94"><span class="type">Hint</span></a><div id="hk-hint-94" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-753">Try drawing a Venn Diagram.</p></div></div>
</div></article><article class="project-like" id="activity-54"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">134</span>.</h6>
<p id="p-756">In <a data-knowl="./knowl/fertilizer2.html" title="Activity 132">Activity¬†132</a>, there were just two fertilizers used to treat the sample plants. Now suppose there are three fertilizer treatments, and 15 plants are treated with nitrates, 16 with potash, 16 with phosphate, 7 with nitrate and potash, 9 with nitrate and phosphate, 8 with potash and phosphate and 4 with all three. Now how many plants have been treated? If 32 plants were studied, how many received no treatment at all?</p></article><article class="project-like" id="threesetintersection"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">135</span>.</h6>
<p id="p-758">A formula for the size of \(A\cup B\cup C\) in terms of the sizes of \(A\text{,}\) \(B\text{,}\) \(C\) and the intersections of these sets is</p>
<div class="displaymath">
\begin{equation*}
|A\cup B\cup C|=|A|+|B|+|C|-|A\cap B|- |A\cap C| - |B\cap
C| +|A\cap B\cap C|\text{.}
\end{equation*}
</div>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel" style="width:65%;justify-content:flex-start;"><p id="p-759">Explain why this is correct using a Venn diagram. In particular, how many times are elements are in \(A \cap B \cap C\) counted?  What about the other regions of the Venn diagram?</p></div>
<div class="sbspanel" style="width:25%;justify-content:flex-start;"><img src="images/three-set-empty-PIE.svg" style="width: 100%; height: auto;" alt=""></div>
</div></div></article></section><section class="subsection" id="subsection-15"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.1.2</span> <span class="title">Unions of an arbitrary number of sets</span>
</h3>
<article class="project-like" id="nsetintersection"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">136</span>.</h6>
<p id="p-760">Conjecture a formula for the size of a union of sets</p>
<div class="displaymath">
\begin{equation*}
A_1\cup
A_2\cup \cdots\cup A_n = \bigcup_{i=1}^n A_i
\end{equation*}
</div>
<p>in terms of the sizes of the sets \(A_i\) and their intersections.</p></article><p id="p-762">The difficulty of generalizing <a data-knowl="./knowl/threesetintersection.html" title="Activity 135">Activity¬†135</a> and <a data-knowl="./knowl/nsetintersection.html" title="Activity 136">Activity¬†136</a> is not likely to be one of being able to see what the right conjecture is, but of finding a good notation to express your conjecture. In fact, it would be easier for some people to express the conjecture in words than to express it in a notation. Here is some notation that will make your task easier. Let us define</p>
<div class="displaymath">
\begin{equation*}
\bigcap_{i:i\in I}A_i
\end{equation*}
</div>
<p>to mean the intersection over all elements \(i\) in the set \(I\) of \(A_i\text{.}\) Thus</p>
<div class="displaymath">
\begin{equation}
\bigcap_{i:i\in
\{1,3,4,6\}} = A_1\cap A_3\cap A_4 \cap A_6.\label{intersectionnotation}\tag{2.1}
\end{equation}
</div>
<p id="p-763">This kind of notation, consisting of an operator with a description underneath of the values of a dummy variable of interest to us, can be extended in many ways. For example</p>
<div class="displaymath">
\begin{align}
\sum_{I:I \subseteq \{1,2,3,4\}, \ |I|=2} |\cap_{i\in I}
A_i|  \amp =  |A_1\cap A_2|+ |A_1\cap A_3|
+|A_1\cap A_4|\notag\\
\amp +  |A_2\cap A_3|+
|A_2\cap A_4| +|A_3\cap A_4|.\label{notationsolution}\tag{2.2}
\end{align}
</div>
<article class="project-like" id="inclusion-exclusionunion"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">137</span>.</h6>
<p id="p-764">Use notation something like that of <a data-knowl="./knowl/intersectionnotation.html" title="Equation 2.1">Equation¬†(2.1)</a> and <a data-knowl="./knowl/notationsolution.html" title="Equation 2.2">Equation¬†(2.2)</a> to express the answer to <a data-knowl="./knowl/nsetintersection.html" title="Activity 136">Activity¬†136</a>. Note there are many different correct ways to do this problem. Try to write down more than one and choose the nicest one you can. Say why you chose it (because your view of what makes a formula nice may be different from somebody else's). The nicest formula won't necessarily involve all the elements of <a data-knowl="./knowl/intersectionnotation.html" title="Equation 2.1">Equations¬†(2.1)</a> and <a data-knowl="./knowl/notationsolution.html" title="Equation 2.2">(2.2)</a>.</p></article><p id="p-766">Whether we try to write down a nice expression for the size of a union or whether we just have the basic idea, we should now be able to answer counting questions like the following.  We will return to this sort of problem in more detail later, but the adventurous reader can attempt it here.</p>
<article class="project-like" id="hatcheck"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">138</span>.</h6>
<div class="introduction" id="introduction-44"><p id="p-767">A group of \(n\) students goes to a restaurant carrying backpacks. The manager invites everyone to check their backpack at the check desk and everyone does. While they are eating, a child playing in the check room randomly moves around the claim check stubs on the backpacks. We will try to compute the probability that, at the end of the meal, at least one student receives his or her own backpack.  This probability is the fraction of the total number of ways to return the backpacks in which at least one student gets his or her own backpack back.</p></div>
<article class="exercise-like" id="task-147"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-768">What is the total number of ways to pass back the backpacks?</p></article><article class="exercise-like" id="task-148"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-770">In how many of the distributions of backpacks to students does at least one student get his or her own backpack?</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-95" id="hint-95"><span class="type">Hint</span> <span class="codenumber">1</span></a><div id="hk-hint-95" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-771">For each student, how big is the set of backpack distributions in which that student gets the correct backpack?  It might be a good idea to first consider cases with \(n=3\text{,}\) \(4\text{,}\) and \(5\text{.}\)</p></div></div>
<a data-knowl="" class="id-ref" data-refid="hk-hint-96" id="hint-96"><span class="type">Hint</span> <span class="codenumber">2</span></a><div id="hk-hint-96" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-772">For each pair of students (say Mary and Jim, for example) how big is the set of backpack distributions in which the students in this pair get the correct backpack. What does the question have to do with unions or intersections of sets. Keep on increasing the number of students for which you ask this kind of question.</p></div></div>
</div></article><article class="exercise-like" id="task-149"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-774">What is the probability that at least one student gets the correct backpack?</p></article><article class="exercise-like" id="hatcheckprobpart"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-776">What is the probability that no student gets his or her own backpack?</p></article><article class="exercise-like" id="task-151"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-778">As the number of students becomes large, what does the probability that no student gets the correct backpack approach?</p></article></article><p id="p-780"><a data-knowl="./knowl/hatcheck.html" title="Exercise 138">Exercise¬†138</a> is ‚Äúclassically‚Äù called the <dfn class="terminology">hatcheck problem</dfn>; the name comes from substituting hats for backpacks. If is also sometimes called the <dfn class="terminology">derangement problem</dfn>. A <dfn class="terminology">derangement</dfn> of an \(n\)-element set is a permutation of that set (thought of as a bijection) that maps no element of the set to itself. One can think of a way of handing back the backpacks as a permutation \(f\) of the students: \(f(i)\) is the owner of the backpack that student \(i\) receives. Then a derangement is a way to pass back the backpacks so that no student gets his or her own.</p></section><section class="subsection" id="subsection-16"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.1.3</span> <span class="title">The Principle of Inclusion and Exclusion</span>
</h3>
<p id="p-781">The formula you have given in <a data-knowl="./knowl/inclusion-exclusionunion.html" title="Exercise 137">Exercise¬†137</a> is often called <dfn class="terminology">the principle of inclusion and exclusion</dfn> for unions of sets. The reason is the pattern in which the formula first adds (includes) all the sizes of the sets, then subtracts (excludes) all the sizes of the intersections of two sets, then adds (includes) all the sizes of the intersections of three sets, and so on.   Notice that we haven't yet proved the principle. There are a variety of proofs.  Perhaps one of the most straightforward (though not the most elegant) is an inductive proof that relies on the fact that</p>
<div class="displaymath">
\begin{equation*}
A_1 \cup A_2 \cup \cdots \cup A_n = \left(A_1 \cup A_2 \cup \cdots \cup A_{n-1}\right) \cup A_n
\end{equation*}
</div>
<p>and the formula for the size of a union of two sets: \(\card{A \cup B} = \card{A} + \card{B} - \card{A\cap B}\text{.}\)</p>
<article class="project-like" id="exploration-83"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">139</span>.</h6>
<p id="p-782">Give a proof of your formula for the principle of inclusion and exclusion.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-97" id="hint-97"><span class="type">Hint</span> <span class="codenumber">1</span></a><div id="hk-hint-97" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-783">Try induction.</p></div></div>
<a data-knowl="" class="id-ref" data-refid="hk-hint-98" id="hint-98"><span class="type">Hint</span> <span class="codenumber">2</span></a><div id="hk-hint-98" class="hidden-content tex2jax_ignore"><div class="solution">
<p id="p-784">We can apply the formula of <a data-knowl="./knowl/twosetintersection.html" title="Activity 133">Activity¬†133</a> to get</p>
<div class="displaymath">
\begin{align*}
\left|\bigcup_{i=1}^n A_i \right| \amp = \left|\left(\bigcup_{i=1}^{n-1} A_i\right) \cup A_n \right| \\
\amp = \left| \bigcup_{i=1}^{n-1} A_i\right| + |A_n| - \left|\left( \bigcup_{i=1}^{n-1} A_i\right) \cap A_n\right|\\
\amp = \left| \bigcup_{i=1}^{n-1} A_i\right| + |A_n| - \left|\bigcup_{i=1}^{n-1} A_i \cap A_n\right|
\end{align*}
</div>
</div></div>
</div></article><p id="p-786">Frequently when we apply the principle of inclusion and exclusion, we will have a situation like that of part (d) of <a data-knowl="./knowl/hatcheckprobpart.html" title="Task 138.d">Task¬†138.d</a>.  That is, we will have a set \(A\) and subsets \(A_1, A_2, \ldots, A_n\) and we will want the size or the probability of the set of elements in \(A\) that are <em class="emphasis">not</em> in the union.  This set is known as the <dfn class="terminology">complement</dfn>  of the union of the \(A_i\)s in \(A\text{,}\) and is denoted by \(A \setminus \bigcup_{i=1}^n A_i\text{,}\) or if \(A\) is clear from context, by \(\overline{\bigcup_{i=1}^n A_i}\text{.}\)</p>
<p id="p-787">Since all the \(A_i\)s are subsets of \(A\text{,}\) one way to write this size is as \(|A| - \sum_{S:S \subseteq [n], S \ne \emptyset}(-1)^{|S|-1} |\bigcap_{i:i \in S}A_i|\text{.}\)  Letting \(|A| = \left|\bigcap_{i:i \in \emptyset} A_i\right|\text{,}\) we may write \(\left|\overline{\bigcup_{i=1}^n A_i}\right| = \sum_{S:S \subseteq [n]} (-1)^{|S|}\left| \bigcap_{i:i\in S} A_i\right|\text{.}\)</p>
<p id="p-788">The principle of inclusion and exclusion generally refers to both this formula and the one for the union.  Both formulas are notationally horrific, but the idea is straight forward.  To find the size of the union, we add the sizes of each set individually, then subtract each of the sizes of the intersections of pairs of sets, then add back in the sizes of the intersections of triples of sets, subtract 4-tuple intersections, add 5-tuple intersections, and so on until we are done.  The compliment can be calculated by subtracting the union from the size of the original set.</p></section><section class="subsection" id="subsec_apps-of-pie"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.1.4</span> <span class="title">Application of Inclusion and Exclusion</span>
</h3>
<a href="sec_adv-pie.html#subsec_apps-of-pie" class="permalink">¬∂</a><article class="paragraphs" id="paragraphs-2"><h5 class="heading"><span class="title">Multisets with restricted numbers of elements.</span></h5>
<article class="project-like" id="act_restrictedmultisetspie"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">140</span>.</h6>
<p id="p-789">In how many ways may we distribute \(k\) identical apples to \(n\) children so that no child gets more than four apples?</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-99" id="hint-99"><span class="type">Hint</span></a><div id="hk-hint-99" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-790">Notice that it is straightforward to figure out how many ways we may pass out the apples so that child \(i\) gets five or more apples: give five apples to child \(i\) and then pass out the remaining apples however you choose. And if  we want to figure out how many ways we may pass out the apples so that a given set \(C\) of children each get five or more apples, we give five to each child in \(C\) and then pass out the remaining \(k-5|C|\) apples however we choose.</p></div></div>
</div></article></article><article class="paragraphs" id="sec-menage"><h5 class="heading"><span class="title">The Menage Problem.</span></h5>
<article class="project-like" id="relaxedmenage"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">141</span>.</h6>
<p id="p-792">A group of \(n\) married couples comes to a group discussion session where they all sit around a round table. In how many ways can they sit so that no person is next to his or her spouse? (Note that two people of the same sex can sit next to each other.)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-100" id="hint-100"><span class="type">Hint</span> <span class="codenumber">1</span></a><div id="hk-hint-100" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-793">Start with two questions that can apply to any inclusion-exclusion problem. Do you think you would be better off trying to compute the size of a union of sets or the size of a complement of a union of sets? What kinds of sets (that are conceivably of use to you) is it easy to compute the size of? (The second question can be interpreted in different ways, and for each way of interpreting it, the answer may help you see something you can use in solving the problem.)</p></div></div>
<a data-knowl="" class="id-ref" data-refid="hk-hint-101" id="hint-101"><span class="type">Hint</span> <span class="codenumber">2</span></a><div id="hk-hint-101" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-794">Suppose we have a set \(S\) of couples whom we want to seat side by side. We can think of lining up \(|S|\) couples and \(2n - 2|S|\) individual people in a circle.  In how many ways can we arrange this many items in a circle?</p></div></div>
</div></article><article class="project-like" id="exploration-86"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">142</span>.</h6>
<p id="p-796">A group of \(n\) married couples comes to a group discussion session where they all sit around a round table. In how many ways can they sit so that no person is next to his or her spouse or a person of the same sex? This problem is called the <dfn class="terminology">menage problem</dfn>.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-102" id="hint-102"><span class="type">Hint</span> <span class="codenumber">1</span></a><div id="hk-hint-102" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-797">Reason somewhat as you did in <a data-knowl="./knowl/relaxedmenage.html" title="Exercise 141">Exercise¬†141</a>, noting that if the set of couples who do sit side-by-side is nonempty, then the sex of the person at each place at the table is determined once we seat one couple in that set.</p></div></div>
<a data-knowl="" class="id-ref" data-refid="hk-hint-103" id="hint-103"><span class="type">Hint</span> <span class="codenumber">2</span></a><div id="hk-hint-103" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-798">Think in terms of the sets \(A_i\) of arrangements of people in which couple \(i\) sits side-by-side. What does the union of the sets \(A_i\) have to do with the problem?</p></div></div>
</div></article></article><article class="paragraphs" id="subsec_derangements"><h5 class="heading"><span class="title">Counting Derangements.</span></h5>
<p id="p-803">A <dfn class="terminology">derangement</dfn> of \(n\) elements \(\{1,2,3,\ldots, n\}\) is a permutation in which no element is fixed. For example, there are \(6\) permutations of the three elements \(\{1,2,3\}\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
123 ~~ 132 ~~ 213 ~~ 231 ~~ 312 ~~ 321.
\end{equation*}
</div>
<p>but most of these have one or more elements fixed: \(123\) has all three elements fixed since all three elements are in their original positions, \(132\) has the first element fixed (1 is in its original first position), and so on. In fact, the only derangements of three elements are</p>
<div class="displaymath">
\begin{equation*}
231 \text{ and } 312.
\end{equation*}
</div>
<p id="p-804">If we go up to 4 elements, there are \(4! = 24\) permutations. How many of these are derangements? If you list out all 24 permutations and eliminate those which are not derangements, you will be left with just 9 derangements. Let's see how we can get that number using PIE.</p>
<article class="project-like" id="activity-57"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">143</span>.</h6>
<article class="exercise-like" id="task-152"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-805">Write out all 24 permutations of \([4]\) and circle the 9 that are derangements.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-104" id="hint-104"><span class="type">Hint</span></a><div id="hk-hint-104" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-806">Note that 2341 should be circled, but 2314 should not be circled.</p></div></div>
</div></article><article class="exercise-like" id="task-153"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-807">Locate the permutations that leave 1 fixed (so 1 is the first number in the permutation).  How many are there, and does this make sense?  Check there are an equal number that leave 2 fixed, and that leave 3 fixed, and that leave 4 fixed.</p></article><article class="exercise-like" id="task-154"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-808">Notice that there are permutations that leave both 1 and 2 fixed.  Which ones are these, and how many are there?  Again, verify that there are just as many that leave any pair of numbers fixed.</p></article><article class="exercise-like" id="task-155"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-809">Repeat the previous task for triples of elements fixed and for all four elements fixed.</p></article><article class="exercise-like" id="task-156"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-810">We can use the principle of inclusion and exclusion to find the total number of derangements as follows:</p>
<div class="displaymath">
\begin{equation*}
d_4 = 4! - \left[{4 \choose 1}3! - {4 \choose 2}2! + {4 \choose 3} 1! - {4 \choose 4}0!\right].
\end{equation*}
</div>
<p>Explain why this is correct.  In particular, for the permutation 1234 (where everything is fixed), where in the expression above is it counted?</p></article></article><p id="p-812">Of course we can use a similar formula to count the derangements of any number of elements. However, the more elements we have, the longer the formula gets. Here is another example:</p>
<article class="project-like" id="exploration-87"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">144</span>.</h6>
<p id="p-813">Five gentlemen attend a party, leaving their hats at the door. At the end of the party, they hastily grab hats on their way out. How many different ways could this happen so that none of the gentlemen leave with their own hat?</p></article><p id="p-815">Derangments are interesting in their own right.  In <a href="sec_basic-proofs.html" class="internal" title="Section 1.2: Proofs in Combinatorics">Section¬†1.2</a> you proved a few results using combinatorial proofs.  In particular, we established the following, which you might try to prove again here.</p>
<article class="theorem-like" id="thm-derangement-recursion"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.1.1</span>.</h6>
<p id="p-816">Let \(d_n\) denote the number of derangments of \(n\text{,}\) with \(d_0 = 1\) and \(d_1 = 0\text{.}\)  Then \(d_n = (n-1)(d_{n-1}+d_{n-2})\text{.}\)</p></article><article class="theorem-like" id="thm-derangment-sum"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.1.2</span>.</h6>
<p id="p-817">Let \(d_n\) denote the number of derangments of \(n\text{,}\) with \(d_0 = 1\) and \(d_1 = 0\text{.}\)  Then</p>
<div class="displaymath">
\begin{equation*}
\binom{n}{0}d_0 + \binom{n}{1}d_1 + \binom{n}{2}d_2 + \cdots + \binom{n}{n}d_n = n!
\end{equation*}
</div></article><p id="p-818">Here is another recursion you can explore.</p>
<article class="project-like" id="exploration-88"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">145</span>.</h6>
<p id="p-819">Use the principle of inclusion and exclusion to derive the recursion</p>
<div class="displaymath">
\begin{equation*}
d_n = nd_{n-1} + (-1)^n\text{.}
\end{equation*}
</div></article><p id="p-820">The non-recursive formula for derangments is messy due to the use of the principle of inclusion and exclusion.  Actually, it can be cleaned up a bit, which leads to a remarkable result.</p>
<article class="project-like" id="exploration-89"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">146</span>.</h6>
<article class="exercise-like" id="task-157"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-821">We know that \(d_3 = 3! - \left(\binom{3}{1}2! - \binom{3}{2}1! + \binom{3}{3}0! \right)\text{.}\)  Use the factorial formula for \(\binom{n}{k}\) to simplify this.  Factor out a \(3!\) leaving terms that are each nice unit fractions.</p></article><article class="exercise-like" id="task-158"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-822">Generalize the previous part to give a nice clean expression for \(d_n\text{.}\)</p></article><article class="exercise-like" id="task-159"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-823">The alternating sum of unit fractions you get might look familiar if you have thought about Taylor series from calculus recently.  For large \(n\text{,}\) what fraction of all permutations are derangements?</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-105" id="hint-105"><span class="type">Hint</span></a><div id="hk-hint-105" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-824">The Taylor series for \(e^x\) is \(1+x + \frac{1}{2!}x^2 + \frac{1}{3!}x^3 + \cdots\text{.}\)  What happens if you replace \(x\) with \(-1\text{?}\)</p></div></div>
</div></article></article></article><article class="paragraphs" id="paragraphs-5"><h5 class="heading"><span class="title">Counting surjective functions.</span></h5>
<p id="p-825">There are six surjective functions  \(f:[3]\to [2]\text{,}\) which happens to be \(2^3 - 2\text{.}\)  This makes sense because there are eight functions all together, but two are not surjective (do you see why?).</p>
<p id="p-826">Consider functions \(f:[3]\to [3]\text{.}\)  Since each element of the domain has three potential images, there are \(3^3\) such functions.  If we only count the injective (one-to-one) functions, we will find \(3! = 6\text{.}\)  Since the size of the domain and codomain are equal, this is also the number of surjective functions (since every injective function is surjective in this case).</p>
<p id="p-827">However, when the size of the codomain is larger than the size of the domain, there will be no injections and plenty of surjections.  To see how to count surjections in general, let's explore the case above where we know the answer already.</p>
<article class="project-like" id="activity-58"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">147</span>.</h6>
<div class="introduction" id="introduction-45">Write out all 27 functions \(f:[3] \to [3]\text{.}\)  You could use two-line notation here, but to save space, perhaps just write the bottom line.  So the function that sends 1 to 1, 2 to 3 and 3 to 3 can be represented as (1,3,3).</div>
<article class="exercise-like" id="task-160"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-828">Circle the functions you found above that are surjective.  Verify that there are just 6.</p></article><article class="exercise-like" id="task-161"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-829">There are various ways that a function might fail to be surjective.  One way is for 1 to not be in the range.  How many functions are there like this (identify them)?  Does this number make sense?  Check this is the same number of functions that do not include 2 in the range.</p></article><article class="exercise-like" id="task-162"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-830">How many functions do not have 1 or 2 in the range?  Does this number make sense as well?</p></article><article class="exercise-like" id="task-163"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-831">Explain what all this has to do with the expression</p>
<div class="displaymath">
\begin{equation*}
3^3 - \left[ \binom{3}{1}2^3 - \binom{3}{2}1^3 + \binom{3}{3}0^3\right]\text{.}
\end{equation*}
</div></article></article><p id="p-832">Let's generalize!</p>
<article class="project-like" id="numontofun"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">148</span>.</h6>
<p id="p-833">Given a function \(f\) from the \(k\)-element set \(K\) to the \(n\)-element set \([n]\text{,}\) we say \(f\) is in the set \(A_i\) if \(f(x)\not= i\) for any \(x\) in \(K\text{.}\)</p>
<p id="p-834">How many of these sets does a surjective function belong to?</p>
<p id="p-835">Use this to find the number of functions from a \(k\)-element set onto an \(n\)-element set?</p></article><article class="project-like" id="exploration-90"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">149</span>.</h6>
<div class="introduction" id="introduction-46"><p id="p-837">If we roll a die eight times, we get a sequence of 8 numbers, the number of dots on top on the first roll, the number on the second roll, and so on.</p></div>
<article class="exercise-like" id="task-164"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-838">What is the number of ways of rolling the die eight times so that each of the numbers one through six appears at least once in our sequence? To get a numerical answer, you will likely need a computer algebra package.</p></article><article class="exercise-like" id="task-165"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-840">What is the probability that we get a sequence in which all six numbers between one and six appear? To get a numerical answer, you will likely need a computer algebra package, programmable calculator, or spreadsheet.</p></article><article class="exercise-like" id="task-166"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-842">How many times do we have to roll the die to have probability at least one half that all six numbers appear in our sequence? To answer this question, you will likely need a computer algebra package, programmable calculator, or spreadsheet.</p></article></article></article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
