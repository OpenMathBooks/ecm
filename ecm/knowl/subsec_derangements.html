<!DOCTYPE html>
<html lang="en-US">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-09-28T11:07:20-06:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body>
<article class="paragraphs"><h5 class="heading"><span class="title">Counting Derangements.</span></h5>
<p>A <dfn class="terminology">derangement</dfn> of \(n\) elements \(\{1,2,3,\ldots, n\}\) is a permutation in which no element is fixed. For example, there are \(6\) permutations of the three elements \(\{1,2,3\}\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
123 ~~ 132 ~~ 213 ~~ 231 ~~ 312 ~~ 321.
\end{equation*}
</div>
<p>but most of these have one or more elements fixed: \(123\) has all three elements fixed since all three elements are in their original positions, \(132\) has the first element fixed (1 is in its original first position), and so on. In fact, the only derangements of three elements are</p>
<div class="displaymath">
\begin{equation*}
231 \text{ and } 312.
\end{equation*}
</div>
<p>If we go up to 4 elements, there are \(4! = 24\) permutations. How many of these are derangements? If you list out all 24 permutations and eliminate those which are not derangements, you will be left with just 9 derangements. Let's see how we can get that number using PIE.</p>
<article class="project-like"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">143</span>.</h6>
<article class="exercise-like"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p>Write out all 24 permutations of \([4]\) and circle the 9 that are derangements.</p>
<div class="solutions"><a data-knowl="./knowl/hint-104-hidden.html" title="Hint 143.a.1"><span class="type">Hint</span></a></div></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p>Locate the permutations that leave 1 fixed (so 1 is the first number in the permutation).  How many are there, and does this make sense?  Check there are an equal number that leave 2 fixed, and that leave 3 fixed, and that leave 4 fixed.</p></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p>Notice that there are permutations that leave both 1 and 2 fixed.  Which ones are these, and how many are there?  Again, verify that there are just as many that leave any pair of numbers fixed.</p></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p>Repeat the previous task for triples of elements fixed and for all four elements fixed.</p></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p>We can use the principle of inclusion and exclusion to find the total number of derangements as follows:</p>
<div class="displaymath">
\begin{equation*}
d_4 = 4! - \left[{4 \choose 1}3! - {4 \choose 2}2! + {4 \choose 3} 1! - {4 \choose 4}0!\right].
\end{equation*}
</div>
<p>Explain why this is correct.  In particular, for the permutation 1234 (where everything is fixed), where in the expression above is it counted?</p></article></article><p>Of course we can use a similar formula to count the derangements of any number of elements. However, the more elements we have, the longer the formula gets. Here is another example:</p>
<article class="project-like"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">144</span>.</h6>
<p>Five gentlemen attend a party, leaving their hats at the door. At the end of the party, they hastily grab hats on their way out. How many different ways could this happen so that none of the gentlemen leave with their own hat?</p></article><p>Derangments are interesting in their own right.  In <a href="sec_basic-proofs.html" class="internal" title="Section 1.2: Proofs in Combinatorics">SectionÂ 1.2</a> you proved a few results using combinatorial proofs.  In particular, we established the following, which you might try to prove again here.</p>
<article class="theorem-like"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.1.1</span>.</h6>
<p>Let \(d_n\) denote the number of derangments of \(n\text{,}\) with \(d_0 = 1\) and \(d_1 = 0\text{.}\)  Then \(d_n = (n-1)(d_{n-1}+d_{n-2})\text{.}\)</p></article><article class="theorem-like"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.1.2</span>.</h6>
<p>Let \(d_n\) denote the number of derangments of \(n\text{,}\) with \(d_0 = 1\) and \(d_1 = 0\text{.}\)  Then</p>
<div class="displaymath">
\begin{equation*}
\binom{n}{0}d_0 + \binom{n}{1}d_1 + \binom{n}{2}d_2 + \cdots + \binom{n}{n}d_n = n!
\end{equation*}
</div></article><p>Here is another recursion you can explore.</p>
<article class="project-like"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">145</span>.</h6>
<p>Use the principle of inclusion and exclusion to derive the recursion</p>
<div class="displaymath">
\begin{equation*}
d_n = nd_{n-1} + (-1)^n\text{.}
\end{equation*}
</div></article><p>The non-recursive formula for derangments is messy due to the use of the principle of inclusion and exclusion.  Actually, it can be cleaned up a bit, which leads to a remarkable result.</p>
<article class="project-like"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">146</span>.</h6>
<article class="exercise-like"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p>We know that \(d_3 = 3! - \left(\binom{3}{1}2! - \binom{3}{2}1! + \binom{3}{3}0! \right)\text{.}\)  Use the factorial formula for \(\binom{n}{k}\) to simplify this.  Factor out a \(3!\) leaving terms that are each nice unit fractions.</p></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p>Generalize the previous part to give a nice clean expression for \(d_n\text{.}\)</p></article><article class="exercise-like"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p>The alternating sum of unit fractions you get might look familiar if you have thought about Taylor series from calculus recently.  For large \(n\text{,}\) what fraction of all permutations are derangements?</p>
<div class="solutions"><a data-knowl="./knowl/hint-105-hidden.html" title="Hint 146.c.1"><span class="type">Hint</span></a></div></article></article></article><span class="incontext"><a href="sec_adv-pie.html#subsec_derangements">in-context</a></span>
</body>
</html>
