<!DOCTYPE html SYSTEM "about:legacy-compat">
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-08-15T14:36:17-06:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Partitions of Sets</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><link href="https://webwork-dev.aimath.org/webwork2_files/js/apps/MathView/mathview.css" rel="stylesheet">
<script src="https://webwork-dev.aimath.org/webwork2_files/js/vendor/iframe-resizer/js/iframeResizer.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.12/pretext.js"></script><script src="https://pretextbook.org/js/0.12/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="custom-styles.css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.12;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(  \def\negchoose#1#2{\genfrac{[}{]}{0pt}{}{#1}{#2}_{-1}}
  \newcommand{\mchoose}[2]{\left(\!\binom{#1}{#2}\!\right)}
  \newcommand{\cycle}[1]{\arraycolsep 5 pt
  \left(\begin{array}#1\end{array}\right)}
  \newcommand{\importantarrow}{\Rightarrow}
  \newcommand{\qchoose}[2]{\left[{#1\atop#2}\right]_q}
  \newcommand{\bp}{
  \begin{enumerate}{\setcounter{enumi}{\value{problemnumber}}}}
  \newcommand{\ep}{\setcounter{problemnumber}{\value{enumi}}
  \end{enumerate}}
  \newcommand{\ignore}[1]{}
  \renewcommand{\bottomfraction}{.8}
  \renewcommand{\topfraction}{.8}
  \newcommand{\apple}{\text{üçé}}
  \newcommand{\ap}{\apple}
  \newcommand{\banana}{\text{üçå}}
  \newcommand{\ba}{\banana}
  \newcommand{\pear}{\text{üçê}}
  \newcommand{\pe}{\pear}
  \DeclareMathOperator{\Fix}{Fix}
  \DeclareMathOperator{\Orb}{Orb}
  \newcommand{\F}{\mathcal{F}}
\newcommand{\alert}{\fbox}
\def\d{\displaystyle}
\def\course{Math 228}
\newcommand{\f}[1]{\mathfrak #1}
\newcommand{\s}[1]{\mathscr #1}
\def\N{\mathbb N}
\def\B{\mathbf{B}}
\def\circleA{(-.5,0) circle (1)}
\def\Z{\mathbb Z}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\Q{\mathbb Q}
\def\circleB{(.5,0) circle (1)}
\def\R{\mathbb R}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\C{\mathbb C}
\def\circleC{(0,-1) circle (1)}
\def\F{\mathbb F}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\A{\mathbb A}
\def\twosetbox{(-2,-1.5) rectangle (2,1.5)}
\def\X{\mathbb X}
\def\threesetbox{(-2,-2.5) rectangle (2,1.5)}
\def\E{\mathbb E}
\def\O{\mathbb O}
\def\U{\mathcal U}
\def\pow{\mathcal P}
\def\inv{^{-1}}
\def\nrml{\triangleleft}
\def\st{:}
\def\~{\widetilde}
\def\rem{\mathcal R}
\def\sigalg{$\sigma$-algebra }
\def\Gal{\mbox{Gal}}
\def\iff{\leftrightarrow}
\def\Iff{\Leftrightarrow}
\def\land{\wedge}
\def\And{\bigwedge}
\def\entry{\entry}
\def\AAnd{\d\bigwedge\mkern-18mu\bigwedge}
\def\Vee{\bigvee}
\def\VVee{\d\Vee\mkern-18mu\Vee}
\def\imp{\rightarrow}
\def\Imp{\Rightarrow}
\def\Fi{\Leftarrow}
\def\var{\mbox{var}}
\def\Th{\mbox{Th}}
\def\entry{\entry}
\def\sat{\mbox{Sat}}
\def\con{\mbox{Con}}
\def\iffmodels{\bmodels\models}
\def\dbland{\bigwedge \!\!\bigwedge}
\def\dom{\mbox{dom}}
\def\rng{\mbox{range}}
\def\isom{\cong}
\DeclareMathOperator{\wgt}{wgt}
\newcommand{\vtx}[2]{node[fill,circle,inner sep=0pt, minimum size=4pt,label=#1:#2]{}}
\newcommand{\va}[1]{\vtx{above}{#1}}
\newcommand{\vb}[1]{\vtx{below}{#1}}
\newcommand{\vr}[1]{\vtx{right}{#1}}
\newcommand{\vl}[1]{\vtx{left}{#1}}
\renewcommand{\v}{\vtx{above}{}}
\def\circleA{(-.5,0) circle (1)}
\def\circleAlabel{(-1.5,.6) node[above]{$A$}}
\def\circleB{(.5,0) circle (1)}
\def\circleBlabel{(1.5,.6) node[above]{$B$}}
\def\circleC{(0,-1) circle (1)}
\def\circleClabel{(.5,-2) node[right]{$C$}}
\def\twosetbox{(-2,-1.4) rectangle (2,1.4)}
\def\threesetbox{(-2.5,-2.4) rectangle (2.5,1.4)}
\def\ansfilename{practice-answers}
\def\shadowprops{{fill=black!50,shadow xshift=0.5ex,shadow yshift=0.5ex,path fading={circle with fuzzy edge 10 percent}}}
\newcommand{\hexbox}[3]{
  \def\x{-cos{30}*\r*#1+cos{30}*#2*\r*2}
  \def\y{-\r*#1-sin{30}*\r*#1}
  \draw (\x,\y) +(90:\r) -- +(30:\r) -- +(-30:\r) -- +(-90:\r) -- +(-150:\r) -- +(150:\r) -- cycle;
  \draw (\x,\y) node{#3};
}
\newcommand{\card}[1]{\left| #1 \right|}
\newcommand{\twoline}[2]{\begin{pmatrix}#1 \\ #2 \end{pmatrix}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href="http://discrete.openmathbooks.org/ecm/" target="_blank"><img src="images/cover.png" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="ecm.html"><span class="title">Exploring Combinatorial Mathematics</span></a></h1>
<p class="byline"></p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="sec_adv-genfunctions.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="ch_advanced.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="sec_adv-linearparts.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="sec_adv-genfunctions.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="ch_advanced.html" title="Up">Up</a><a class="next-button button toolbar-item" href="sec_adv-linearparts.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="frontmatter.html" data-scroll="frontmatter"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
<li><a href="preface.html" data-scroll="preface">Preface</a></li>
</ul>
</li>
<li class="link">
<a href="ch_basic-combinatorics.html" data-scroll="ch_basic-combinatorics"><span class="codenumber">1</span> <span class="title">Basic Combinatorics</span></a><ul>
<li><a href="sec_counting-binom.html" data-scroll="sec_counting-binom">Pascal's Triangle and Binomial Coefficients</a></li>
<li><a href="sec_basic-proofs.html" data-scroll="sec_basic-proofs">Proofs in Combinatorics</a></li>
<li><a href="sec_basic-quotient.html" data-scroll="sec_basic-quotient">Counting with Equivalence</a></li>
<li><a href="sec_basic-recursion.html" data-scroll="sec_basic-recursion">Counting with Recursion</a></li>
<li><a href="sec_basic-catalan.html" data-scroll="sec_basic-catalan">The Catalan Numbers</a></li>
</ul>
</li>
<li class="link">
<a href="ch_advanced.html" data-scroll="ch_advanced"><span class="codenumber">2</span> <span class="title">Advanced Combinatorics</span></a><ul>
<li><a href="sec_adv-pie.html" data-scroll="sec_adv-pie">The Principle of Inclusion and Exclusion: the Size of a Union</a></li>
<li><a href="sec_adv-genfunctions.html" data-scroll="sec_adv-genfunctions">Generating Functions</a></li>
<li><a href="sec_adv-stirling.html" data-scroll="sec_adv-stirling" class="active">Partitions of Sets</a></li>
<li><a href="sec_adv-linearparts.html" data-scroll="sec_adv-linearparts">Partitions of Integers</a></li>
</ul>
</li>
<li class="link">
<a href="ch_graphtheory.html" data-scroll="ch_graphtheory"><span class="codenumber">3</span> <span class="title">Graph Theory</span></a><ul>
<li><a href="sec_gt-intro.html" data-scroll="sec_gt-intro">Definitions</a></li>
<li><a href="sec_paths.html" data-scroll="sec_paths">Walking Around Graphs</a></li>
<li><a href="sec_planar.html" data-scroll="sec_planar">Planar Graphs and Euler's Formula</a></li>
<li><a href="sec_eulerapps.html" data-scroll="sec_eulerapps">Applications of Euler's Formula</a></li>
<li><a href="sec_coloring.html" data-scroll="sec_coloring">Coloring</a></li>
<li><a href="sec_matchings.html" data-scroll="sec_matchings">Matching in Bipartite Graphs</a></li>
</ul>
</li>
<li class="link"><a href="backmatter.html" data-scroll="backmatter"><span class="title">Back Matter</span></a></li>
<li class="link">
<a href="app_projects.html" data-scroll="app_projects"><span class="codenumber">A</span> <span class="title">Group Projects</span></a><ul>
<li><a href="exercises-1.html" data-scroll="exercises-1">Project 1: Paths and Binomial Coefficients</a></li>
<li><a href="exercises-2.html" data-scroll="exercises-2">Project 2: On Triangular Numbers</a></li>
<li><a href="exercises-3.html" data-scroll="exercises-3">Project 3: Fibonacci</a></li>
<li><a href="exercises-4.html" data-scroll="exercises-4">Project 4: Generalized Pascal Triangles</a></li>
<li><a href="exercises-5.html" data-scroll="exercises-5">Project 5: A Pascal-like Triangle of Eulerian Numbers</a></li>
<li><a href="exercises-6.html" data-scroll="exercises-6">Project 6: The Leibniz Harmonic Triangle</a></li>
<li><a href="exercises-7.html" data-scroll="exercises-7">Project 7: The Twelve Days of Christmas (in the Discrete Math Style)</a></li>
</ul>
</li>
<li class="link">
<a href="ch_background.html" data-scroll="ch_background"><span class="codenumber">B</span> <span class="title">Background Material</span></a><ul>
<li><a href="sec_background-statements.html" data-scroll="sec_background-statements">Mathematical Statements</a></li>
<li><a href="sec_intro-sets.html" data-scroll="sec_intro-sets">Sets</a></li>
<li><a href="sec_background-functions.html" data-scroll="sec_background-functions">Functions</a></li>
<li><a href="sec_background-logic.html" data-scroll="sec_background-logic">Propositional Logic</a></li>
<li><a href="sec_background-proofs.html" data-scroll="sec_background-proofs">Proofs</a></li>
<li><a href="sec_background-induction.html" data-scroll="sec_background-induction">Induction</a></li>
</ul>
</li>
<li class="link"><a href="solutions-1.html" data-scroll="solutions-1"><span class="codenumber">C</span> <span class="title">Hints to selected activities and exercises</span></a></li>
<li class="link"><a href="solutions-2.html" data-scroll="solutions-2"><span class="codenumber">D</span> <span class="title">Solutions to selected exercises</span></a></li>
<li class="link"><a href="appendix-gfdl.html" data-scroll="appendix-gfdl"><span class="codenumber">E</span> <span class="title">GNU Free Documentation License</span></a></li>
<li class="link"><a href="appendix-4.html" data-scroll="appendix-4"><span class="codenumber">F</span> <span class="title">List of Symbols</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
<li class="link"><a href="colophon-2.html" data-scroll="colophon-2"><span class="title">Colophon</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="sec_adv-stirling"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">2.3</span> <span class="title">Partitions of Sets</span>
</h2>
<a href="sec_adv-stirling.html" class="permalink">¬∂</a><section class="introduction" id="introduction-56"><p id="p-1052">Partitions are one of the core ideas in discrete mathematics.  Recall that a <dfn class="terminology">partition</dfn> of a set \(S\) is a collection of mutually disjoint subsets of \(S\) whose union is all of \(S\text{.}\)  In other words, every element of \(S\) belongs to exactly one of the subsets of the partition.  We call the subsets that make up the partition <dfn class="terminology">blocks</dfn> or <dfn class="terminology">parts</dfn> of the partition.</p>
<p id="p-1053">The integers can be naturally partitioned into evens and odds.  In fact, this is just a specific case of partitioning the integers by their reminder when divided by a fixed constant; another example is that every integer has remainder 0, 1, or 2 when divided by 3.</p>
<p id="p-1054">Finite sets also have natural partitions: the set of all 4-bit strings can be partitioned according to weight:</p>
<div class="displaymath">
\begin{equation*}
\B^4_0 \cup \B^4_1 \cup B^4_2 \cup \B^4_3 \cup \B^4_4 = \B^4\text{.}
\end{equation*}
</div>
<p>Using the sum principle on these disjoint sets leads directly to the identity \(\binom{4}{0} + \binom{4}{1} + \binom{4}{2} + \binom{4}{3} + \binom{4}{4} = 2^4\) (and of course the 4 can be replaced with any \(n\) here).</p>
<p id="p-1055">In fact, many of the identities we established in <a href="sec_basic-proofs.html" class="internal" title="Section 1.2: Proofs in Combinatorics">Section¬†1.2</a> using a combinatorial proof work precisely because we can count a set of outcomes all at once and also by counting the size of each block in a particular partition.  For example, in <a data-knowl="./knowl/act_derangement-binom.html" title="Exercise 39">Exercise¬†39</a> we proved that</p>
<div class="displaymath">
\begin{equation*}
\binom{n}{0} d_{0} + \binom{n}{1} d_{1} + \binom{n}{2} d_{2} + \ldots + \binom{n}{n} d_{n} = n!
\end{equation*}
</div>
<p>by partitioning the \(n!\) permutations of \([n]\) into blocks according to how many are fixed in position while the rest are deranged.</p>
<p id="p-1056">Even the formula for binomial coefficients, \(\binom{n}{k} = \frac{n!}{(n-k)!k!}\text{,}\) comes from partitioning the \(k\)-permutations of \([n]\) into blocks according to which subset of \([n]\) is selected (and then \(\binom{n}{k}\) is precisely the number of blocks).</p>
<p id="p-1057">In this section we will abstract this fundamental idea of partitions by one level.  Instead of using particular partitions to answer counting questions, we will ask counting questions about partitions themselves.  As we will see, this helps us solve yet more counting questions.</p>
<p id="p-1058">In <a href="sec_basic-quotient.html" class="internal" title="Section 1.3: Counting with Equivalence">Section¬†1.3</a> we considered some ways to distribute items to recipients.  Most basic counting formulas can be thought of as counting the number of ways to distribute either distinct or identical items to distinct recipients.  For example, distributing \(k\) distinct items to \(n\) distinct recipients can be done in \(n^k\) ways, if recipients can receive any number of items, or \(P(n,k)\) ways if recipients can receive at most one item.  If the items are identical, the corresponding number of ways to distribute them are \(\mchoose{n}{k}\) and \(\binom{n}{k}\text{.}\)</p>
<p id="p-1059">What if the recipients are not distinct?  Say we wish to distribute \(k\) books (either distinct or identical) to \(n\) identical boxes.  This is a perfectly natural extension, but we will see the answer is not.  First, let's get a feel for what this might look like for some small values of \(k\) and \(n\text{.}\)</p>
<article class="project-like" id="act_stirlingintro"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">191</span>.</h6>
<div class="introduction" id="introduction-57"><p id="p-1060">Suppose you have \(3\) distinct books you want to put into \(5\) identical boxes.</p></div>
<article class="exercise-like" id="task-197"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1061">How many ways can you do this if each box can have at most one book?</p></article><article class="exercise-like" id="task-198"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1062">How many ways can you do this if any box can have any number of books?  You might want to consider three cases: one, two, or three boxes are used.  Assume we do not care about the order in which the books are placed inside boxes.</p></article><article class="exercise-like" id="task-199"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1063">Describe the outcomes we are counting in abstract mathematical terms.  What sort of mathematical objects are we counting?</p></article></article><article class="project-like" id="act_intpartintro"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">192</span>.</h6>
<div class="introduction" id="introduction-58"><p id="p-1064">Suppose you have \(3\) identical books you want to put in \(5\) identical boxes.</p></div>
<article class="exercise-like" id="task-200"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1065">How many ways can you do this if each box can have at most one book?</p></article><article class="exercise-like" id="task-201"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1066">How many ways can you do this if any box can have any number of books?  Again, you should consider three cases.</p></article><article class="exercise-like" id="task-202"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1067">What mathematical objects are we counting here?</p></article></article><p id="p-1068">Both of the previous two activities can be solved by counting partitions.  The difference comes down to whether we partition a set of distinct objects or identical objects.  It is not immediately clear how to model partitioning identical objects, and we will put this off until <a href="sec_adv-linearparts.html" class="internal" title="Section 2.4: Partitions of Integers">Section¬†2.4</a>.  Partitioning <em class="emphasis">distinct</em> objects simply means finding a partition of a set, the topic of the current section.</p></section><section class="subsection" id="subsection-25"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.3.1</span> <span class="title">Stirling Numbers of the Second Kind</span>
</h3>
<p id="p-1069">We would like to count the number of ways to partition a set.</p>
<article class="definition-like" id="def-stirling"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">2.3.1</span>.</h6>
<p id="p-1070">Denote by \(S(k,n)\) the number of partitions of \([k]\) into exactly \(n\) subsets.  We call \(S(k,n)\) a <dfn class="terminology">Stirling number (of the second kind)</dfn>.</p></article><p id="p-1071">Note that we write \(S(k,n)\) instead of \(S(n,k)\) here because we try to use \(k\) for the number of elements being distributed and \(n\) for the number of recipients.  When other books use \(S(n,k)\text{,}\) they mean the number of partitions of \([n]\) into exactly \(k\) blocks.  This is the same definition as we give, but with our renamed variables the formulas we get might look different.</p>
<p id="p-1072">For example, consider how to partition \([3]\) into exactly two sets:</p>
<div class="displaymath">
\begin{equation*}
\{1,2\}, \{3\} \qquad \qquad \{1,3\},\{2\} \qquad \qquad \{2,3\},\{1\}
\end{equation*}
</div>
<p>and that is all, so \(S(3,2) = 3\text{.}\)  We do not care about the order the elements appear in each block, nor the order in which the blocks appear.  Thus we see the Stirling numbers count the number of ways to distribute \(k\) distinct items to \(n\) identical recipients so that each recipient gets at least one item.</p>
<article class="project-like" id="act_stirlingcomputations"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">193</span>.</h6>
<div class="introduction" id="introduction-59"><p id="p-1073">Get to know the Stirling numbers by finding some.  List the set of partitions and count them.</p></div>
<article class="exercise-like" id="task-203"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1074">Find \(S(3,1)\text{,}\) \(S(4,1)\) and \(S(k,1)\text{.}\)</p></article><article class="exercise-like" id="task-204"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1075">Compute \(S(2,2)\text{,}\) \(S(3,2)\) and \(S(4,2)\text{.}\)  Find a formula for \(S(k,2)\) and prove it is correct.</p></article><article class="exercise-like" id="task-205"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1076">Compute \(S(3,3)\text{,}\) and \(S(4,3)\text{.}\)</p></article><article class="exercise-like" id="task-206"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1077">Find formulas and give proofs for \(S(k,k)\) and \(S(k,k - 1)\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-132" id="hint-132"><span class="type">Hint</span></a><div id="hk-hint-132" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1078">What are the possible sizes of parts?</p></div></div>
</div></article></article><p id="p-1080">We can arrange the Stirling numbers into a triangle (called <dfn class="terminology">Stirling's second triangle</dfn>).  The first five rows are shown below.  The entries are indexed differently than in Pascal's triangle: the top 1 represents \(S(1,1)\text{,}\) so for example, \(S(5,2) = 15\text{.}\)</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">6</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">25</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
</tr>
</table></div></div></div>
<p id="p-1081">How were these found?  Sure, we could have written out all 25 of the partitions of \([5]\) into exactly \(3\) blocks, but we didn't.  Could there be some way to get 25 from the entries above it?  That is, what is the recurrence relation among the Stirling numbers?</p>
<article class="project-like" id="activity-82"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">194</span>.</h6>
<p id="p-1082">Write down (if you haven't already) all 6 partitions of \([4]\) into \(3\) blocks.  Break these into two cases by where 4 is: is 4 in solitary confinement (in a singleton set) or does he have a cellmate?</p></article><p id="p-1083">Now that you have some experience with listing the \(S(4,3)\) partitions of \([4]\text{,}\) the next example will help us to generalize.</p>
<article class="example-like" id="example-30"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.3.2</span>.</h6>
<p id="p-1084">Let's see how to take \(S(4,2) = 7\) and \(S(4,3) = 6\) to compute \(S(5,3) = 25\text{.}\)</p>
<p id="p-1085">First, here are the partitions of \([4]\) into 2 blocks (group A) or 3 blocks (group B), side by side:</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:5%;margin-right:5%;">
<div class="sbspanel" style="width:55.5555555555556%;justify-content:flex-start;">
<p id="p-1086">Group A:</p>
<div class="displaymath">
\begin{align*}
\{1\}, ~ \{2,3,4\}\qquad \amp \{1,2\}, ~ \{3, 4\}\\
\{2\}, ~ \{1,3,4\}\qquad \amp \{1,3\}, ~ \{2, 4\}\\
\{3\}, ~ \{1,2,4\} \qquad \amp \{2,3\}, ~ \{1, 4\}\\
\{4\}, ~ \{1,2,3\} \qquad\amp 
\end{align*}
</div>
</div>
<div class="sbspanel" style="width:33.3333333333333%;justify-content:flex-start;">
<p id="p-1087">Group B:</p>
<div class="displaymath">
\begin{gather*}
\{3\}, ~ \{1,2\}, ~ \{4\}\\
\{2\}, ~ \{1,3\}, ~ \{4\}\\
\{2\}, ~ \{1,4\}, ~ \{3\}\\
\{1\}, ~ \{2,3\}, ~ \{4\}\\
\{1\}, ~ \{2,4\}, ~ \{3\}\\
\{1\}, ~ \{3,4\}, ~ \{2\}
\end{gather*}
</div>
</div>
</div></div>
<p id="p-1088">(Notice the \(\binom{4}{2}\) ways of listing the middle column in group B.)</p>
<p id="p-1089">Now, to list the \(S(5,3)\) partitions of \([5]\) into \(3\) parts, we need to add 5 somewhere.  We can either</p>
<ol class="lower-alpha">
<li id="li-44"><p id="p-1090">Let 5 be a singleton block, along with any of the partitions from group A; or</p></li>
<li id="li-45"><p id="p-1091">Let 5 join any of the blocks in any of the partitions of group B.</p></li>
</ol>
<p>The second option can be accomplished in \(3\cdot 6\) ways.  Thus \(S(5,3) = 7 + 3\cdot 6\text{.}\)</p></article><article class="project-like" id="secondstirlingrecurrence"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">195</span>.</h6>
<p id="p-1092">Now generalize.  In a partition of the set \([k]\text{,}\) the number \(k\) is either in a block by itself, or it is not.  Find a two variable recurrence for \(S(k,n)\text{,}\) valid for \(k\) and \(n\) larger than one.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-133" id="hint-133"><span class="type">Hint</span></a><div id="hk-hint-133" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1093">The number of partitions of \([k]\) into \(n\) parts in which \(k\) is not in a block relates to the number of partitions of \(k-1\) into some number of blocks in a way that involves \(n\text{.}\) With this in mind, review how you proved Pascal's (recurrence) equation.</p></div></div>
</div></article><article class="project-like" id="exploration-113"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">196</span>.</h6>
<p id="p-1095">Find a recurrence for the Lah numbers \(L(k,n)\) similar to the one in <a data-knowl="./knowl/secondstirlingrecurrence.html" title="Activity 195">Activity¬†195</a>.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-134" id="hint-134"><span class="type">Hint</span></a><div id="hk-hint-134" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1096">To see how many broken permutations of a \(k\) element set into \(n\) parts do not have \(k\) is a part by itself, ask yourself how many broken permutations of \([7]\) result from adding 7 to the one of the two permutations in the broken permutation \(\{14, 2356\}\text{.}\)</p></div></div>
</div></article><article class="project-like" id="sandwiches"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">197</span>.</h6>
<p id="p-1098">Extend Stirling's triangle enough to allow you to answer the following question and answer it. (Don't fill in the rows all the way; the work becomes quite tedious if you do. Only fill in what you need to answer this question.) A caterer is preparing three bag lunches for hikers. The caterer has nine different sandwiches. In how many ways can these nine sandwiches be distributed into three identical lunch bags so that each bag gets at least one?</p></article><p id="p-1101">We have often thought of counting problems as asking about how many functions there are from a \(k\)-elements set to an \(n\)-element set.  The answer to this question is \(n^k\) for all functions and \(P(n,k)\) for injective functions.  What about surjective functions?  There is a reason we haven't asked this question yet, but now we can at least get an expression for the number of surjections in terms of Stirling numbers.</p>
<article class="project-like" id="exploration-115"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">198</span>.</h6>
<p id="p-1102">Given a function \(f\) from a \(k\)-element set \(K\) to an \(n\)-element set, we can define a partition of \(K\) by putting \(x\) and \(y\) in the same block of the partition if and only if \(f(x)=f(y)\text{.}\) How many blocks does the partition have if \(f\) is surjective? How is the number of functions from a \(k\)-element set <em class="emphasis">onto</em> an \(n\)-element set related to a Stirling number? Be as precise in your answer as you can.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-135" id="hint-135"><span class="type">Hint</span></a><div id="hk-hint-135" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1103">You can think of a function as assigning values to the blocks of its partition. If you permute the values assigned to the blocks, do you always change the function?</p></div></div>
</div></article><p id="p-1105">We do not have an explicit formula for either the number of surjections or for \(S(k,n)\) yet, but note that if we could find either, we would now have both.  We will see one approach to this soon.</p>
<article class="project-like" id="Stirlingfalling"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">199</span>.</h6>
<p id="p-1106">Each function from a \(k\)-element set \(K\) to an \(n\)-element set \(N\) is a function from \(K\) onto <em class="emphasis">some</em> subset of \(N\text{.}\) If \(J\) is a subset of \(N\) of size \(j\text{,}\) you know how to compute the number of functions that map onto \(J\) in terms of Stirling numbers. Suppose you add the number of functions mapping onto \(J\) over all possible subsets \(J\) of \(N\text{.}\) What simple value should this sum equal? Write the equation this gives you.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-136" id="hint-136"><span class="type">Hint</span></a><div id="hk-hint-136" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1107">When you add the number of functions mapping onto \(J\) over all possible subsets \(J\) of \(N\text{,}\) what is the set of functions whose size you are computing?</p></div></div>
</div></article><article class="project-like" id="exploration-117"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">200</span>.</h6>
<p id="p-1109">In how many ways can the sandwiches of <a data-knowl="./knowl/sandwiches.html" title="Exercise 197">Exercise¬†197</a> be placed into three distinct bags so that each bag gets at least one?</p></article><p id="p-1111">We will further investigate Stirling numbers in the rest of this section, but first, notice that we have not looked at the number of ways to partition a set into <em class="emphasis">any</em> number of blocks.</p>
<article class="definition-like" id="def-bell"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">2.3.3</span>.</h6>
<p id="p-1112">The total number of partitions of a \(k\)-element set is denoted by \(B_k\) and is called the \(k\)-th <dfn class="terminology">Bell number</dfn>.</p></article><article class="example-like" id="example-31"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.3.4</span>.</h6>
<p id="p-1113">There are five partitions of \([3]\text{:}\)</p>
<div class="displaymath">
\begin{gather*}
\{1\}, \{2\},\{3\}\\
\{1,2\},\{3\} \qquad \{1,3\},\{2\} \qquad \{1\}, \{2,3\}\\
\{1,2,3\}
\end{gather*}
</div>
<p>Note that \(B_3 = S(3,1)+S(3,2)+S(3,3) = 1 + 3 + 1\text{.}\)</p></article><article class="project-like" id="BellNumberIntro"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">201</span>.</h6>
<article class="exercise-like" id="task-207"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1114">Why is \(B_k = \sum_{n=1}^{k} S(k,n)\text{,}\) but \(n^k \ne \sum_{n=1}^k S(k,n)n!\text{?}\)  Why is this a meaningful question?</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-137" id="hint-137"><span class="type">Hint</span></a><div id="hk-hint-137" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1115">As to why this is a reasonable question, think of distributing \(k\) items to \(n\) recipients.  All four expressions count the number of ways to do this under different restrictions.</p></div></div>
</div></article><article class="exercise-like" id="task-208"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1116">Find a recurrence that expresses \(B_k\) in terms of \(B_n\) for \(n\lt  k\) and prove your formula correct in as many ways as you can.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-138" id="hint-138"><span class="type">Hint</span></a><div id="hk-hint-138" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1117">Here it is helpful to think about what happens if you delete the entire block containing \(k\) rather than thinking about whether \(k\) is in a block by itself or not.</p></div></div>
</div></article><article class="exercise-like" id="task-209"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1120">Find \(B_k\) for \(k=1,2,4,5,6\text{.}\)</p></article></article><p id="p-1122">The Bell numbers are interesting in their own right, and we will look at them more in <a href="sec_adv-stirling.html#subsec_bell" class="internal" title="Subsection 2.3.4: Bell Numbers">Subsection¬†2.3.4</a>.</p></section><section class="subsection" id="subsec-stirlingformulas"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.3.2</span> <span class="title">Formulas for Stirling Numbers (of the second kind)</span>
</h3>
<a href="sec_adv-stirling.html#subsec-stirlingformulas" class="permalink">¬∂</a><p id="p-1123">Here is a brief summary of what we have already discovered.</p>
<p id="p-1124">Directly from the definition, we see that \(S(k,1) = 1\) and \(S(k,k) = 1\text{.}\)  From these we can compute the remaining Stirling numbers using the recursion</p>
<div class="displaymath">
\begin{equation*}
S(k,n) = nS(k-1,n) + S(k-1, n-1).
\end{equation*}
</div>
<p>This recursion is justified by dividing the partitions of \([k]\) into those which contain \(k\) as a singleton set (there are \(S(k-1, n-1)\) of these) and those that don't (there are \(n\) choices for where \(k\) could be for each of the \(S(k-1, n)\) partitions of \([k-1]\) into \(n\) blocks).</p>
<p id="p-1125">From this, we generated Stirling's second triangle.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:25%;margin-right:25%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">6</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">25</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
</tr>
</table></div></div></div>
<article class="project-like" id="exploration-118"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">202</span>.</h6>
<p id="p-1126">Use the recursion to find the 6th row of the triangle.</p></article><p id="p-1127">Let's consider some ways to compute Stirling numbers directly.</p>
<p id="p-1128">While we might not have a nice closed formula for all Stirling numbers in terms of \(k\) and \(n\text{,}\) we can give closed formulas for those Stirling numbers close to the edges of the triangle.  We have already considered some of these in <a data-knowl="./knowl/act_stirlingcomputations.html" title="Activity 193">Activity¬†193</a>.  To get back into the right mindset, start by reproving one of these.</p>
<article class="project-like" id="exploration-119"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">203</span>.</h6>
<p id="p-1129">Prove \(S(k, k-1) = \binom{k}{2}\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-139" id="hint-139"><span class="type">Hint</span></a><div id="hk-hint-139" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1130">What are the possible sizes of parts?</p></div></div>
</div></article><p id="p-1132">The proof of the formula above suggests that looking at the sizes of the blocks might be helpful.  Let's see what this might look like with an example.</p>
<article class="project-like" id="activity-85"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">204</span>.</h6>
<div class="introduction" id="introduction-60"><p id="p-1133">How many ways are there to partition \([5]\) into three sets?</p></div>
<article class="exercise-like" id="task-210"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1134">How many partitions of \([5]\) have two blocks of size 1 and one block of size 3?</p></article><article class="exercise-like" id="task-211"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1136">How many partitions of \([5]\) have one block of size 1 and two of size 2?</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-140" id="hint-140"><span class="type">Hint</span></a><div id="hk-hint-140" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1137">Careful here.  The answer is NOT \(\binom{5}{2}\binom{3}{2}\text{.}\)  Do you see why?</p></div></div>
</div></article><article class="exercise-like" id="task-212"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1139">Are there any other types of partitions we need to consider?  What is \(S(5,3)\text{?}\)</p></article><article class="exercise-like" id="task-213"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1141">Generalize! Find a formula for \(S(k, k-2)\text{.}\)</p></article><article class="exercise-like" id="task-214"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-1143">A friend tells you that \(S(k,k-2) = \binom{k}{3} + 3 \binom{k}{4}\text{.}\)  Prove this is correct also.  If this is the formula you found for the previous part, see the hint.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-141" id="hint-141"><span class="type">Hint</span></a><div id="hk-hint-141" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1144">If you found this formula for \(S(k,k-2)\) in part (e), then pretend your friend claims that \(S(k, k-2) = \binom{k}{3} + \frac{1}{2}\binom{k}{2}\binom{k-2}{2}\) and prove why that is correct too.</p></div></div>
</div></article></article><p id="p-1146"> Whenever we want to partition \(k\) items in \(n\) blocks, we can consider cases.  We will represent each type of case with a <dfn class="terminology">type vector</dfn> consisting of a sequence \((a_1, a_2, \ldots, a_k)\) where each \(a_i\) is the number of blocks that have size \(i\text{.}\)  For example, in partitioning \([5]\) into 3 blocks, the previous activity first asked for the number of partitions with type vector \((2,0,1,0,0)\text{,}\) two blocks of size 1 and one of size 3, and then for the number of partitions with type vector \((1,2,0,0,0)\text{,}\) one block of size 1 and two of size 2.  Note that \(\sum_{i=1}^k a_i = n\) and \(\sum_{i=1}^k ia_i = k\text{.}\)</p>
<article class="project-like" id="activity-86"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">205</span>.</h6>
<article class="exercise-like" id="task-215"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1147">How many partitions of \([6]\) are there into 3 blocks?  List all the type vectors and the number of partitions for each.</p></article><article class="exercise-like" id="task-216"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1148">Generalize to find a formula for \(S(k,k-3)\text{.}\)  Then clean up the formula so it is a linear combination of \(\binom{k}{4}\text{,}\) \(\binom{k}{5}\text{,}\) and \(\binom{k}{6}\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-142" id="hint-142"><span class="type">Hint</span></a><div id="hk-hint-142" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1149">While you might not get this formula by conisdering type vectors, you should be shooting to prove \(S(k, k-3) = \binom{k}{4} + 10 \binom{k}{5} + 16 \binom{k}{6}\)</p></div></div>
</div></article></article><article class="project-like" id="partitionsgivenpartsize"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">206</span>.</h6>
<p id="p-1150">In how many ways can we partition \(k\) items into \(n\) blocks so that we have \(a_i\) blocks of size \(i\) for each \(i\text{?}\) That is, given the type vector \((a_1, a_2, \ldots, a_k)\text{,}\) how many partitions of \([k]\) into \(n\) blocks have that type vector.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-143" id="hint-143"><span class="type">Hint</span></a><div id="hk-hint-143" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1151">Suppose we make a list of the \(k\) items. We take the first \(a_1\) elements to be the blocks of size 1. How many elements do we need to take to get \(a_2\) blocks of size two? Which elements does it make sense to choose for this purpose?</p></div></div>
</div></article><article class="project-like" id="activity-88"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">207</span>.</h6>
<p id="p-1153">Describe how to compute \(S(k,n)\) in terms of quantities given by the formula you found in <a data-knowl="./knowl/partitionsgivenpartsize.html" title="Activity 206">Activity¬†206</a>.</p></article><article class="project-like" id="activity-89"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">208</span>.</h6>
<p id="p-1155">Explain why \(S(k, 2) = 2^{k-1} - 1\text{.}\)  Then find another expression for \(S(k,2)\) using type vectors to establish an interesting identity.</p></article><article class="paragraphs" id="pars-multinomial"><h5 class="heading"><span class="title">Interlude: Multinomial Coefficients.</span></h5>
<p id="p-1156">Recall that the Stirling numbers counted the number of ways to distribute 9 distinct sandwiches to three identical sandwich bags.  This suggests a more realistic question.</p>
<article class="project-like" id="caterer2"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">209</span>.</h6>
<p id="p-1157">In how many ways may the caterer distribute the nine sandwiches into three identical bags so that each bag gets exactly three? Answer this question.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-144" id="hint-144"><span class="type">Hint</span></a><div id="hk-hint-144" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1158">What if the question asked about six sandwiches and two distinct bags? How does having identical bags change the answer?</p></div></div>
</div></article><article class="project-like" id="activity-91"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">210</span>.</h6>
<p id="p-1160">In how many ways can the sandwiches of <a data-knowl="./knowl/caterer2.html" title="Activity 209">Activity¬†209</a> be placed into <em class="emphasis">distinct</em> bags so that each bag gets exactly three?</p></article><p id="p-1163">This is an example of a <dfn class="terminology">multinomial coefficient</dfn>.  Although these are not directly related to Stirling numbers, we can use the ideas of type vectors to investigate them.  Let's do that now.</p>
<article class="project-like" id="activity-92"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">211</span>.</h6>
<p id="p-1164">In how many ways may we label the elements of a \(k\)-element set with \(n\) distinct labels (numbered 1 through \(n\)) so that label \(i\) is used \(j_i\) times? (If we think of the labels as \(y_1, y_2, \ldots, y_n\text{,}\) then we can rephrase this question as follows.  How many functions are there from a \(k\)-element set \(K\) to a set \(N=\{y_1,y_2,\ldots y_n\}\) so that \(y_i\) is the image of \(j_i\) elements of \(K\text{?}\)) This number is called a <dfn class="terminology">multinomial coefficient</dfn> and denoted by</p>
<div class="displaymath">
\begin{equation*}
\binom{k}{j_1,j_2,\ldots, j_n}.
\end{equation*}
</div>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-145" id="hint-145"><span class="type">Hint</span> <span class="codenumber">1</span></a><div id="hk-hint-145" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1165">What if the \(j_i\)'s don't add to \(k\text{?}\)</p></div></div>
<a data-knowl="" class="id-ref" data-refid="hk-hint-146" id="hint-146"><span class="type">Hint</span> <span class="codenumber">2</span></a><div id="hk-hint-146" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1166">Think about listing the elements of the \(k\)-element set and labeling the first \(j_1\) elements with label number 1.</p></div></div>
</div></article><article class="project-like" id="activity-93"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">212</span>.</h6>
<p id="p-1168">Explain how to compute the number of functions from a \(k\)-element set \(K\) to an \(n\)-element set \(N\) by using multinomial coefficients.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-147" id="hint-147"><span class="type">Hint</span></a><div id="hk-hint-147" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1169">The sum principle will help here.</p></div></div>
</div></article><article class="project-like" id="activity-94"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">213</span>.</h6>
<p id="p-1171">Explain how to compute the number of functions from a \(k\)-element set \(K\) onto an \(n\)-element set \(N\) by using multinomial coefficients.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-148" id="hint-148"><span class="type">Hint</span></a><div id="hk-hint-148" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1172">How are the relevant \(j_i\)'s in the multinomial coefficients you use here different from the \(j_i\)'s in the previous problem.</p></div></div>
</div></article><article class="project-like" id="activity-95"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">214</span>.</h6>
<p id="p-1174">What do multinomial coefficients have to do with expanding the \(k\)th power of a multinomial \(x_1+x_2+\cdots+x_n\text{?}\) This result is called the <dfn class="terminology">multinomial theorem</dfn>.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-149" id="hint-149"><span class="type">Hint</span></a><div id="hk-hint-149" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1175">Think about how binomial coefficients relate to expanding a power of a binomial and note that the binomial coefficient \(\binom{n}{k}\) and the multinomial coefficient \(\binom{n}{k,n-k}\) are the same.</p></div></div>
</div></article></article></section><section class="subsection" id="subsec-stirlingidentities"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.3.3</span> <span class="title">Identities with Stirling Numbers</span>
</h3>
<a href="sec_adv-stirling.html#subsec-stirlingidentities" class="permalink">¬∂</a><p id="p-1177">The entries in the Pascal Triangle, \(\binom{n}{k}\text{,}\) satisfy the nice recursion \(\binom{n}{k} = \binom{n - 1}{k} + \binom{n - 1}{k - 1}\) and also have a closed formula: \(\binom{n}{k} = \frac{n!}{k!(n - k)!}\text{.}\) <a data-knowl="./knowl/secondstirlingrecurrence.html" title="Activity 195">Activity¬†195</a> gives us a recursion for the Stirling numbers \(S(k,n)\) and, unfortunately, the best we can do for a ‚Äúclosed‚Äù formula is the following.<a data-knowl="" class="id-ref" data-refid="hk-fn-10" id="fn-10"><sup>‚Äâ7‚Äâ</sup></a><span id="hk-fn-10" class="hidden-content tex2jax_ignore"><span class="footnote">This is not really a closed formula since the number of terms in the summation is not fixed.</span></span></p>
<article class="theorem-like" id="thm-stirling-closed"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.3.5</span>.</h6>
<div class="displaymath" id="p-1178">
\begin{equation*}
S(k,n) = \frac{1}{n!}\left[n^{k} - \binom{n}{1} \left( n - 1 \right)^{k} + \binom{n}{2} \left( n - 2 \right)^{k} - \ldots + \left( - 1 \right)^{n - 1}\binom{n}{n - 1} 1^{k} \right] 
\end{equation*}
</div></article><p id="p-1179">We will prove this following an approach due to Polya.  The idea is to compare Stirling numbers to surjections, which we know how to count using the principle of inclusion and exclusion (see <a href="sec_adv-pie.html#subsec_apps-of-pie" class="internal" title="Subsection 2.1.4: Application of Inclusion and Exclusion">Subsection¬†2.1.4</a>).</p>
<article class="project-like" id="act_stirlingpie"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">215</span>.</h6>
<div class="introduction" id="introduction-61"><p id="p-1180">Suppose you wished to paint \(k\) houses and you have \(n\) different colors available.  Each house will get a single color, but you want to ensure that each color is used at least once.</p></div>
<article class="exercise-like" id="task-217"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1181">Use the principle of inclusion and exclusion to write a formula for the number of ways to paint the houses.</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-150" id="hint-150"><span class="type">Hint</span></a><div id="hk-hint-150" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1182">In what way is this problem like counting functions?</p></div></div>
</div></article><article class="exercise-like" id="task-218"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1183">What about the paint colors and the houses does \(S(k,n)\) count?  Why does this NOT answer the question?  By what factor are we off?</p></article><article class="exercise-like" id="task-219"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1184">Conclude that a formula for the Stirling numbers is</p>
<div class="displaymath">
\begin{equation*}
S(k,n) = \frac{1}{n!}\sum_{s=0}^n (-1)^s\binom{n}{s}(n-s)^k.\text{.}
\end{equation*}
</div></article></article><article class="project-like" id="activity-97"><h6 class="heading">
<span class="type">Activity</span> <span class="codenumber">216</span>.</h6>
<p id="p-1185">What does <a data-knowl="./knowl/thm-stirling-closed.html" title="Theorem 2.3.5">Theorem¬†2.3.5</a> tell us about \(S(k, 2)\) (which we already know)?  What do we get for \(S(k,3)\text{?}\)</p></article><p id="p-1188">Here is another identity involving Stirling numbers.</p>
<article class="theorem-like" id="thm-stirling-polynomial"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.3.6</span>.</h6>
<p id="p-1189">\(x^{k} = S\left(k,1 \right)x + S\left(k,2 \right)x\left( x - 1 \right) + S\left(k,3 \right)x\left( x - 1 \right)\left( x - 2 \right) + \cdots
+ S\left(k,k \right)x\left( x - 1 \right)\cdots(x -k + 1)\)</p></article><article class="project-like" id="exploration-120"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">217</span>.</h6>
<p id="p-1190">Prove <a data-knowl="./knowl/thm-stirling-polynomial.html" title="Theorem 2.3.6">Theorem¬†2.3.6</a></p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-151" id="hint-151"><span class="type">Hint</span></a><div id="hk-hint-151" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-1191">You have already done this as well, although not with \(x\text{.}\)</p></div></div>
</div></article><p id="p-1193">It is in this form that James Stirling originally developed these numbers. \(S(k,n)\) is used to convert from powers to binomial  coefficients as shown in the following:</p>
<article class="theorem-like" id="thm-stirling-polynomial2"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">2.3.7</span>.</h6>
<p id="p-1194">\(x^{k} = S\left(k,1 \right)\binom{x}{1}1! + S\left(k,2 \right) \binom{x}{2}2! + \ldots + S\left(k,k \right)\binom{x}{k} k!\)</p></article><article class="project-like" id="exploration-121"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">218</span>.</h6>
<p id="p-1195">Prove <a data-knowl="./knowl/thm-stirling-polynomial2.html" title="Theorem 2.3.7">Theorem¬†2.3.7</a></p></article><p id="p-1196">As an example of the previous two theorems, consider how to write \(x^3\text{.}\)</p>
<p id="p-1197">Using <a data-knowl="./knowl/thm-stirling-polynomial.html" title="Theorem 2.3.6">Theorem¬†2.3.6</a>, we can write</p>
<div class="displaymath">
\begin{equation*}
x^3 = S(3,1)x + S(3,2)x(x-1) + S(3,3)x(x-1)(x-2) = x + 3x(x-1) + x(x-1)(x-2)\text{.}
\end{equation*}
</div>
<p>Recognizing that the factors that involve \(x\) look like a factorial, we can convert them into binomial coefficients, which is what <a data-knowl="./knowl/thm-stirling-polynomial2.html" title="Theorem 2.3.7">Theorem¬†2.3.7</a> says:</p>
<div class="displaymath">
\begin{equation*}
x^3 = \binom{x}{1} + 3\binom{x}{2}2! + \binom{x}{3}3! = \binom{x}{1} + 6\binom{x}{2} + 6 \binom{x}{3}.
\end{equation*}
</div>
<p id="p-1198">Less we think this is nothing more than an interesting factoid, we can use it to establish the following.</p>
<article class="example-like" id="example-32"><h6 class="heading">
<span class="type">Example</span> <span class="codenumber">2.3.8</span>.</h6>
<p id="p-1199">Prove that \(1^3 + 2^3 + 3^3 + \cdots + n^3 = \left(\frac{n(n+1)}{2}\right)^2\text{.}\)  In other words, the square of any triangular number is the sum of cubes!</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-solution-170" id="solution-170"><span class="type">Solution</span></a><div id="hk-solution-170" class="hidden-content tex2jax_ignore"><div class="solution">
<p id="p-1200">We recognize that each cube on the left-hand side can be expressed as \(\binom{x}{1} + 6 \binom{x}{2} + 6\binom{x}{3}\text{.}\)  Thus</p>
<div class="displaymath">
\begin{align*}
1^3 + 2^3 + \cdots + n^3 = \amp \sum_{x=1}^n \left(\binom{x}{1} + 6 \binom{x}{2} + 6\binom{x}{3}\right)\\
= \amp \sum_{x=1}^n \binom{x}{1} + 6 \sum_{x=1}^n \binom{x}{2} + 6 \sum_{x=1}^n \binom{x}{3}\text{.}
\end{align*}
</div>
<p>Now each of the three sums of binomial coefficients can be simplified using the Hockey Stick Theorem, to get</p>
<div class="displaymath">
\begin{align*}
=  \amp \binom{n+1}{2} + 6 \binom{n+1}{3} + 6 \binom{n+1}{4} \\
= \amp \binom{n+1}{2} + 6\left(\binom{n+1}{3}+\binom{n+1}{4}\right) \\
= \amp \binom{n+1}{2} + 6\binom{n+2}{4} 
\end{align*}
</div>
<p>where the last step uses the Pascal triangle recurrence.</p>
<p id="p-1201">Finally, write these last two binomial coefficients using the factorial formula and simplify:</p>
<div class="displaymath">
\begin{equation*}
\frac{n(n+1)}{2} + \frac{(n+2)(n+1)n(n-1)}{4} = \left(\frac{n(n+1)}{2}\right)^2\text{.}
\end{equation*}
</div>
</div></div>
</div></article><p id="p-1202">The remainder of this section contains some additional activities related to the identities above and Stirling numbers in general.</p>
<article class="project-like" id="exploration-122"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">219</span>.</h6>
<p id="p-1203">List the sequence of elements that are row sums of the Stirling Triangle.</p></article><article class="project-like" id="exploration-123"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">220</span>.</h6>
<p id="p-1204">How many subsets \(\{a,b,c\}\) are there of \(\{2,3,4,\ldots\}\) such that \(abc = 2 \cdot 3 \cdot 5 \cdot 7 \cdot 11 \cdot 13 \cdot 17\text{?}\)</p></article><article class="project-like" id="exploration-124"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">221</span>.</h6>
<p id="p-1205">Let \(S = \{2,3,4,\ldots\}\text{.}\)  How many ordered triples \((a,b,c)\) are there in \(S\times S \times S\) such that \(abc = 2 \cdot 3 \cdot 5 \cdot 7 \cdot 11 \cdot 13 \cdot 17\text{?}\)</p></article><article class="project-like" id="exploration-125"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">222</span>.</h6>
<div class="introduction" id="introduction-62"><p id="p-1206">Determine the following:</p></div>
<article class="exercise-like" id="task-220"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1207">\(a, b, c\) so that \(n^4 = 24\binom{n}{4} + 6a\binom{n}{3}+2b\binom{n}{2} + c \binom{n}{1}\text{.}\)</p></article><article class="exercise-like" id="task-221"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1208">\(a, b, c, d\) so that \(n^5 = 5!\binom{n}{5} + a\binom{n}{4} + b\binom{n}{3} + c \binom{n}{2} + d \binom{n}{1}\text{.}\)</p></article></article><article class="project-like" id="exploration-126"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">223</span>.</h6>
<p id="p-1209">Express \(1^4 + 2^4 + 3^4 + \cdots + n^4\) as a polynomial in \(n\text{.}\)</p></article><article class="project-like" id="exploration-127"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">224</span>.</h6>
<p id="p-1210">Why is \(4^k - 4\cdot 3^k + 6\cdot 2^k - 4\) always divisible by 24?</p></article></section><section class="subsection" id="subsec_bell"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">2.3.4</span> <span class="title">Bell Numbers</span>
</h3>
<a href="sec_adv-stirling.html#subsec_bell" class="permalink">¬∂</a><p id="p-1211">The Bell number, \(B_{k}\text{,}\) denotes the number of ways that a set of \(k\) objects can be partitioned into nonempty subsets. We have already seen how to partition a set of \(k\) objects into exactly \(n\) subsets: \(S(k,n)\text{.}\)  So then \(B_k = \sum_{n=1}^kS(k,n)\text{.}\)  We take \(B_0 = 1\text{.}\)</p>
<p id="p-1212">The sequence of Bell numbers starts</p>
<div class="displaymath">
\begin{equation*}
1, 1, 2, 5, 15, 52, 203, 877, 4140, 21147, 115975, \ldots
\end{equation*}
</div>
<p>Notice that the first four numbers look like Catalan numbers.  In fact, one of the many things the Catalan numbers count are <em class="emphasis">non-crossing</em> set partitions.<a data-knowl="" class="id-ref" data-refid="hk-fn-11" id="fn-11"><sup>‚Äâ8‚Äâ</sup></a><span id="hk-fn-11" class="hidden-content tex2jax_ignore"><span class="footnote">A set partition is said to be <dfn class="terminology">non-crossing</dfn> as long as whenever \(a,b\) belong to one block and \(c,d\) belong to another, we have that \(a\) and \(b\) are both either larger or smaller than both of \(c\) and \(d\text{.}\)</span></span>  So if \(C_n\) counts only some of the set partitions, then it must be that \(C_n \le B_n\) for all \(n\text{.}\)</p>
<p id="p-1213">The Bell numbers can be generated by constructing what is called the Bell Triangle. To construct this triangle, begin with a 1 at the top and a 1 below it. Add these two numbers together and put the sum 2, to the right of the 1 in the second column. This 2 is also the first entry of the third row. The second entry in the third row is found by adding the 2 to the number 1 above it. This sum is 3 and goes to the right of the 2. The 3 is now below a 2. Adding these two numbers produces the last number, 5, in the third row. Since 5 has no number above it, the third row is complete. 5 now becomes the first number in the fourth row and the process continues.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:15%;margin-right:15%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines">5</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">5</td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines">20</td>
<td class="l m b0 r0 l0 t0 lines">27</td>
<td class="l m b0 r0 l0 t0 lines">37</td>
<td class="l m b0 r0 l0 t0 lines">52</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">52</td>
<td class="l m b0 r0 l0 t0 lines">67</td>
<td class="l m b0 r0 l0 t0 lines">87</td>
<td class="l m b0 r0 l0 t0 lines">114</td>
<td class="l m b0 r0 l0 t0 lines">151</td>
<td class="l m b0 r0 l0 t0 lines">203</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">203</td>
<td class="l m b0 r0 l0 t0 lines">255</td>
<td class="l m b0 r0 l0 t0 lines">322</td>
<td class="l m b0 r0 l0 t0 lines">409</td>
<td class="l m b0 r0 l0 t0 lines">523</td>
<td class="l m b0 r0 l0 t0 lines">674</td>
<td class="l m b0 r0 l0 t0 lines">877</td>
</tr>
</table></div></div></div>
<p id="p-1214">To summarize, construction of the triangle follows two basic rules:</p>
<ol class="decimal">
<li id="li-46"><p id="p-1215">The last number of each row is the first number of the next row.</p></li>
<li id="li-47"><p id="p-1216">All other numbers are found by adding the number to the left of the missing number to the number directly above this same number.</p></li>
</ol>
<p>When the triangle is extended, as above, the Bell Numbers are found down the first column as well as along the outside diagonal.</p>
<article class="project-like" id="exploration-128"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">225</span>.</h6>
<p id="p-1217">Why does this triangle construction give you the Bell numbers?  Explain in terms of set partitions.</p></article><p id="p-1218">As with Pascal's Triangle, the Bell triangle has several interesting properties.</p>
<article class="project-like" id="exploration-129"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">226</span>.</h6>
<p id="p-1219">If the sum of a row is added to the Bell number at the end of that row, the next Bell number is obtained. For example, the sum of the fourth row plus the Bell number at the end of the row: \(15 + 20 + 27 + 37 + 52 + 52\) is 203, the next Bell number.  Why does this happen?</p></article><article class="project-like" id="exploration-130"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">227</span>.</h6>
<p id="p-1220">Another pattern you might notice: the numbers of the second diagonal \(1, 3, 10, 37, 151, 674, \ldots\) are the sums of the horizontal rows.  Prove this!</p></article><p id="p-1221">Rotating the triangle slightly creates a <em class="emphasis">difference</em> triangle analogous to Pascal's Triangle. The entries that are formed recursively by adding in Pascal's Triangle are now differences of the two numbers above them in the Bell triangle.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">5</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">52</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">203</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">877</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">1</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">3</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">10</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">37</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">151</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">674</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">2</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">7</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">27</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">114</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">523</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">5</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">20</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">87</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">409</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">15</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">67</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">322</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">52</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">255</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines">203</td>
<td class="l m b0 r0 l0 t0 lines">\(\ldots\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
</table></div></div></div>
<article class="project-like" id="exploration-131"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">228</span>.</h6>
<p id="p-1222">Explain why the differences work as they do in the rotated triangle.</p></article><p id="p-1223">Finally, rewriting the Bell triangle recursively indicates a nice connection of the Bell Numbers to Pascal's triangle.</p>
<div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;"><div class="sbspanel fixed-width" style="width:100%;justify-content:flex-start;"><table>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(B_{0} = B_{1}\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(B_{1}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{0} + B_{1} = B_{2}\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(B_{2}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{1} + B_{2}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{0} + 2B_{1} + B_{2} = B_{3}\)</td>
<td class="l m b0 r0 l0 t0 lines"></td>
</tr>
<tr>
<td class="l m b0 r0 l0 t0 lines">\(B_{3}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{2} + B_{3}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{1} + B_{2} + B_{2} + B_{3}\)</td>
<td class="l m b0 r0 l0 t0 lines">\(B_{0} + 3B_{1} + 3B_{2} + B_{3} = B_{4}\)</td>
</tr>
</table></div></div></div>
<p id="p-1224">This pattern suggests the \({(n + 1)}^{\text{th}}\) Bell Number can be represented recursively by \(B_{n + 1} = \binom{n}{0} B_{0} + \binom{n}{1} B_{1} + \binom{n}{2}B_{2} + \ldots + \binom{n}{n} B_{n}\text{.}\) The coefficients of this equation are the entries of the \(n\)th row of Pascal's triangle.</p>
<article class="project-like" id="act_bellrecurrence"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">229</span>.</h6>
<p id="p-1225">Prove the recurrence</p>
<div class="displaymath">
\begin{equation*}
B_{k + 1} = \binom{k}{0} B_{0} + \binom{k}{1} B_{1} + \binom{k}{2}B_{2} + \ldots + \binom{k}{k} B_{k}
\end{equation*}
</div></article><p id="p-1226">The Bell numbers are related to the Stirling numbers and can be defined as the sum of the Stirling numbers of the second kind. That is, \(B_{k} = S(k,1) + S(k,2) + \cdots + S(k,k)\text{,}\) where \(S(k,n)\) represents the number of ways of grouping \(k\) elements into \(n\) subsets. So \(B_{3} = S(3,1) + S(3,2) + S(3,3) = 1 + 3 + 1 = 5\text{.}\) Since the Bell numbers count the partitions of a set of elements, they are used in prime-number theory to enumerate the number of ways to factor a number with distinct prime factors. For example, 42 has three distinct prime factors: 2, 3, and 7. Since \(B_{3} = 5\) , we know there are five ways of factoring 42. These are \(2 \times 3 \times 7\text{,}\) \(2 \times 21\text{,}\) \(3 \times 14\text{,}\) \(6 \times 7\text{,}\) and \(42\text{.}\) So the number \(210\text{,}\) which has 4 distinct factors, 2, 3, 5, and 7, can be factored in \(B_{4} = 15\) ways.</p>
<p id="p-1227">The Bell numbers can be used to model many real-life situations. For example, the number of different ways two people can sleep in unlabeled twin beds is \(B_{2} = 2\) ways: They can sleep in the same bed or in separate beds. The number of ways of serving a dinner consisting of three items, such as a salad, bread, and fish is \(B_{3} = 5\) ways: each could be served on a separate plate, salad and bread could be on one plate and fish on another, salad and fish on one plate and bread on another, or all three items could be on the same plate. This example serves as a model for the five ways three people can occupy three unlabeled beds, the five ways three prisoners can be handcuffed together, the five ways three nations can be form alliances, or any situation of partitioning three distinct elements into non-empty subsets.</p>
<p id="p-1228">One interesting application of Bell numbers is in counting the number of rhyme schemes possible for a stanza in poetry. There are \(B_{2} = 2\) possibilities for a two-line stanza: the lines can either rhyme or not rhyme. The possible rhyme schemes of a three-line stanza can be described as aaa, aab, aba, abb, and abc: thus there are 5 or \(B_{3}\) possible rhyme schemes. The Japanese used diagrams depicting possible rhyme schemes of a five-line stanza \(B_{5} = 52\) as early as 1000 A.D. in the <em class="emphasis">Tale of the Genji</em> by Lady Shikibu Murasaki.</p>
<article class="project-like" id="exploration-133"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">230</span>.</h6>
<p id="p-1229">List all 15 rhyme schemes for a four-line stanza.  Identify the \(C_4 = 14\) such schemes that are ‚Äúplanar‚Äù (and say what this means).</p></article><article class="project-like" id="exploration-134"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">231</span>.</h6>
<p id="p-1230">List all 15 set partitions of \([4]\text{.}\)  Identify the \(C_4 = 14\) such partitions that are ‚Äúnon-crossing‚Äù (and say what this means).</p></article><p id="p-1231">We conclude with an interesting exercise.</p>
<article class="project-like" id="exploration-135"><h6 class="heading">
<span class="type">Exercise</span> <span class="codenumber">232</span>.</h6>
<p id="p-1232">The set \(\{u_{0}, u_{1}, u_{2}, \ldots \}\) where \(u_{0} = 1\text{,}\) \(u_{1} = x\text{,}\) \(u_{2} = x(x - 1)\text{,}\) \(u_{3} = x(x - 1)(x - 2)\text{,}\) etc., is a basis for the vector space \(V\) of all polynomials with real coefficients. Let \(P(x) = c_{0}u_{0} + c_{1}u_{1} + c_{2}u_{2} + \cdots\) be any element of \(V\text{,}\) and define the functional \(L\) as follows: \(L\lbrack P(x)\rbrack = c_{0} + c_{1} + \cdots\text{.}\)</p>
<ol id="p-1233" class="decimal">
<li id="li-48"><p id="p-1234">Prove that \(L\left\lbrack P\left( x \right) + Q\left( x \right) \right\rbrack = L\left\lbrack P\left( x \right) \right\rbrack + L\left\lbrack Q\left( x \right) \right\rbrack.\)</p></li>
<li id="li-49"><p id="p-1235">Prove that \(L\left\lbrack rP \left( x \right) \right\rbrack = rL\lbrack P\left( x \right)\rbrack\) for \(r \in \R\) (the Reals).</p></li>
<li id="li-50"><p id="p-1236">Prove that \(B_{n} = L\lbrack x^{n}\rbrack\) .</p></li>
<li id="li-51"><p id="p-1237">Prove that \(L\left\lbrack x^{n + 1} \right\rbrack = L\lbrack\left( x + 1 \right)^{n}\rbrack\) .</p></li>
<li id="li-52"><p id="p-1238">Derive the recursion in <a data-knowl="./knowl/act_bellrecurrence.html" title="Exercise 229">Exercise¬†229</a> using the previous part.</p></li>
</ol></article></section></section></div></main>
</div>
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.12/login.js"></script>
</body>
</html>
